<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Tingnan Gong" />

<meta name="date" content="2020-12-20" />

<title>homework</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
border-bottom: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic tfoot tr td {
border: 0;
}
.lightable-classic tfoot tr:first-child td {
border-top: 0.14em solid #111111;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
border-bottom: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 tfoot tr td {
border: 0;
}
.lightable-classic-2 tfoot tr:first-child td {
border-top: 3px double #111111;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material tfoot tr td {
border: 0;
}
.lightable-material tfoot tr:first-child td {
border-top: 1px solid #EEE;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark tfoot tr td {
border: 0;
}
.lightable-material-dark tfoot tr:first-child td {
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper tfoot tr td {
border: 0;
}
.lightable-paper tfoot tr:first-child td {
border-top: 1px solid #00000020;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework</h1>
<h4 class="author">Tingnan Gong</h4>
<h4 class="date">2020-12-20</h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#hw-0-before-fomally-start">HW 0: Before fomally start</a><ul>
<li><a href="#example-1">Example 1</a></li>
<li><a href="#example-2">Example 2</a></li>
<li><a href="#example-3">Example 3</a></li>
</ul></li>
<li><a href="#hw-1-introduction">HW 1: Introduction</a><ul>
<li><a href="#section">3.3</a><ul>
<li><a href="#solution.">Solution.</a></li>
</ul></li>
<li><a href="#section-1">3.9</a><ul>
<li><a href="#solution.-1">Solution.</a></li>
</ul></li>
<li><a href="#section-2">3.10</a><ul>
<li><a href="#solution.-2">Solution.</a></li>
</ul></li>
<li><a href="#section-3">3.13</a><ul>
<li><a href="#solution.-3">Solution.</a></li>
</ul></li>
</ul></li>
<li><a href="#hw-2-random-number-generation">HW 2: Random number generation</a><ul>
<li><a href="#section-4">5.1</a></li>
<li><a href="#section-5">5.7</a></li>
<li><a href="#section-6">5.11</a></li>
</ul></li>
<li><a href="#hw-3-monte-carlo-integration">HW 3: Monte Carlo integration</a><ul>
<li><a href="#section-7">5.13</a><ul>
<li><a href="#solution.-4">Solution.</a></li>
</ul></li>
<li><a href="#section-8">5.15</a><ul>
<li><a href="#solution.-5">Solution.</a></li>
</ul></li>
<li><a href="#section-9">6.4</a><ul>
<li><a href="#solution.-6">Solution.</a></li>
</ul></li>
</ul></li>
<li><a href="#hw-4-monte-carlo-methods-in-inference">HW 4: Monte Carlo methods in inference</a><ul>
<li><a href="#section-10">6.7</a><ul>
<li><a href="#solution.-7">Solution.</a></li>
</ul></li>
<li><a href="#section-11">6.8</a><ul>
<li><a href="#solution.-8">Solution.</a></li>
</ul></li>
<li><a href="#c">6.C</a><ul>
<li><a href="#solution.-9">Solution.</a></li>
</ul></li>
<li><a href="#discussion.">Discussion.</a><ul>
<li><a href="#solution.-10">Solution.</a></li>
</ul></li>
</ul></li>
<li><a href="#hw-5-boostrap-jackknife-permutation">HW 5: Boostrap Jackknife Permutation</a><ul>
<li><a href="#section-15">7.1</a><ul>
<li><a href="#solution.-11">Solution.</a></li>
</ul></li>
<li><a href="#section-16">7.5</a><ul>
<li><a href="#solution.-12">Solution.</a></li>
</ul></li>
</ul></li>
<li><a href="#hw-6-markov-chain-montel-carlo-methods">HW 6: Markov Chain Montel Carlo methods</a><ul>
<li><a href="#section-17">8.3</a><ul>
<li><a href="#solution.-13">Solution.</a></li>
</ul></li>
<li><a href="#design-experiments-for-evaluating-the-performance-of-the-nn-energy-and-ball-methods-in-various-situations.">Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</a><ul>
<li><a href="#solution.-14">Solution.</a></li>
</ul></li>
</ul></li>
<li><a href="#hw-7-numerical-methods-in-r">HW 7: Numerical methods in R</a><ul>
<li><a href="#section-18">9.4</a><ul>
<li><a href="#solution.-15">Solution.</a></li>
</ul></li>
<li><a href="#section-19">11.4</a><ul>
<li><a href="#solution.-16">Solution.</a></li>
</ul></li>
</ul></li>
<li><a href="#hw-8-r-programming-techniques">HW 8: R programming techniques</a><ul>
<li><a href="#question-1.">Question 1.</a><ul>
<li><a href="#solution.-17">Solution.</a></li>
</ul></li>
<li><a href="#exercise-3-page-204-advanced-r">Exercise 3, Page 204, Advanced R</a><ul>
<li><a href="#solution.-18">Solution.</a></li>
<li><a href="#lapply">lapply</a></li>
</ul></li>
<li><a href="#exercise-3-page-213-advanced-r">Exercise 3, Page 213, Advanced R</a><ul>
<li><a href="#solution.-19">Solution.</a></li>
<li><a href="#anonymous-function">Anonymous function</a></li>
<li><a href="#section-20">[[]]</a></li>
</ul></li>
<li><a href="#exercise-6-page-214-advanced-r">Exercise 6, Page 214, Advanced R</a><ul>
<li><a href="#solution.-20">Solution.</a></li>
</ul></li>
</ul></li>
<li><a href="#hw-9-high-performance-with-rcpp">HW 9: High performance with Rcpp</a><ul>
<li><a href="#former-answer-for-exercise-9.4">Former Answer for Exercise 9.4</a></li>
<li><a href="#rcpp-for-exercise-9.4">RCpp for Exercise 9.4</a><ul>
<li><a href="#qq-plot">QQ plot</a></li>
<li><a href="#time-comparison">Time Comparison</a></li>
<li><a href="#comments">Comments</a></li>
</ul></li>
</ul></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p><strong>StatComp20026</strong> is a package designed in the course <strong>Statistical Computing</strong> in University of Science and Technology of China, advised by Prof. Hong Zhang and assisted by Ph.D. Anran Liu.</p>
<p>The current vignette simply contains all the homework of the course <strong>Statistical Computing</strong>.</p>
<p>For several functions useful in model selection, please refer to vignette <strong>model_selection</strong>.</p>
</div>
<div id="hw-0-before-fomally-start" class="section level1">
<h1>HW 0: Before fomally start</h1>
<div id="example-1" class="section level2">
<h2>Example 1</h2>
<p>Plug in a figure which is a network,</p>
<div class="figure">
<img src="data:image/png;base64,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rX2j/YSLI+wBADCAX/3qV+bdd981P/zhDxtDltxxxx3mgw8+aP01n67BlMvqSv1XxxrLa4+dp9uT/fZdJvr0R0x08HITjccB8LpxE90zYaKnDpd3BW66tD9a+4bBlftD2AMAoA8KdRrI9yc/+Yl59dVXG6FOrWBJ8LBL4W8QExNxoErm98efdYce3/V6HN7i5Wmw5MZyt23trMNG9cyt7nkVWdofreVrP+HiCHsAAKS4Wus2CnauOn36dGtO+YyPj3fmV9awK8ufaSzvE5/4RHvZe/fuNddcc4259NJL2z9PTk6az32u2eXbqNuucs+vqLKGX9F+wsUR9gAAIytLa91Gpenvu+++xuMVDjU/zXcQXctwBZ4i6lvNQZx1Htz999/fCHZd62ENeaI6efJk59y+r0y651lUWeuBi2MvAQBGwqCtdZpWj9Fj1XJ37ty5gc/N28hQWvZe7bTotev2q030W3eZ6N8cb06jLtTn4mDX+vvzzz/f+Lr1w9tN9JOSuptp2cuMsAcACEpVW+uyGMo5expm5a5rTDR5ZbM2a6375icb63bFFVeYL3zhC831nC/p/D3O2cuMsAcAqK06tdZlMZSrcbPWFTsb6/fiiy821/Po9e7pfBdX42ZG2AMAVF4IrXVZDGWcvaz1xVsa6/eVr3yluZ6Hr3BP57sYZy8zwh4AoFJCba3LYih30MhaX7ursX7az4311Dh8rul8F3fQyIywBwAYilFrrctiaPfGzVJf+lhj/b70pS8111MDL7um813cGzczwh4AoHC01mWzurra2X4NeeIKPb7r8weaXbFqobu9j7Hzjt3QWL9nn322uZ73XueezndZQ8BoP+HiCHsAAG9orfNjfX29e78UPfyKdYVru77+Cfe0SV1zaWO6p59+ujn9bxx2T+ezrGFXVNpPuDjCHgAgF1rrijU93RzkuFGLU+7w47M+1hxEeW5urrnMzVr3nv14YxpdINH+n//OJ93T+iztBy0rLu0f9IewBwDYFK11w7G0tNTZh/fud4cfn/Xi7Y1l3XvvvZ374959rYn++aeaAyafOd68Evah69vr9cgjrZa2eybc8/Rd2g+tZWv/oD+EPQBAG6111aFA3N63l253hx+f9aefN9H1lzWWd/z4cbNr167O8lO1Y8eORihs/+7No+55+i7th9YytX/QH8IeAIwgWuvqoWtw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" alt="A Network" width="30%" />
<p class="caption">
A Network
</p>
</div>
</div>
<div id="example-2" class="section level2">
<h2>Example 2</h2>
<p>Plug in a table which contains observed random variables,</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">ncol =</span> <span class="dv">5</span>), <span class="dt">col.names =</span> <span class="kw">paste</span>(<span class="st">&quot;Col&quot;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dt">sep =</span> <span class="st">&quot; &quot;</span>),  <span class="dt">caption =</span> <span class="st">&quot;A Random Matrix&quot;</span>)</span></code></pre></div>
<table>
<caption>A Random Matrix</caption>
<thead>
<tr class="header">
<th align="right">Col 1</th>
<th align="right">Col 2</th>
<th align="right">Col 3</th>
<th align="right">Col 4</th>
<th align="right">Col 5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.7284270</td>
<td align="right">0.6890931</td>
<td align="right">-0.9620073</td>
<td align="right">-1.5307560</td>
<td align="right">0.5274000</td>
</tr>
<tr class="even">
<td align="right">-0.4548072</td>
<td align="right">1.0529753</td>
<td align="right">0.3260819</td>
<td align="right">-1.5051075</td>
<td align="right">0.0059344</td>
</tr>
<tr class="odd">
<td align="right">0.2581042</td>
<td align="right">-0.6532883</td>
<td align="right">0.6103144</td>
<td align="right">1.9537536</td>
<td align="right">-0.2711078</td>
</tr>
<tr class="even">
<td align="right">2.2912373</td>
<td align="right">1.1182955</td>
<td align="right">0.0275299</td>
<td align="right">0.2006019</td>
<td align="right">-0.1205737</td>
</tr>
<tr class="odd">
<td align="right">1.2448264</td>
<td align="right">-0.6817627</td>
<td align="right">0.0542927</td>
<td align="right">-2.0226350</td>
<td align="right">-0.2131713</td>
</tr>
</tbody>
</table>
</div>
<div id="example-3" class="section level2">
<h2>Example 3</h2>
<p>Plug in some formula</p>
<p><span class="math display">\[
\begin{aligned}
\mathcal{LL}_{cp} =&amp; 
        \sum_{t_i&lt;\tau}
        \log\left(\sum_{t_j&lt;t_i}\alpha_{u_i,u_j}\beta e^{-\beta(t_i-t_j)}\right)
        -\sum_{j=1}^d\sum_{t_i&lt;\tau}\alpha_{j,u_i}\left(1-e^{-\beta(\tau-t_i)}\right)\\
        +&amp;\sum_{\tau\leq t_i&lt;t}\log\left(\sum_{t_j&lt;\tau} \alpha_{u_i,u_j}\beta e^{-\beta(\tau-t_j)} \right)-(t-\tau)\sum_{j=1}^d\sum_{t_i&lt;\tau}\alpha_{j,u_i}\beta e^{-\beta(\tau-t_i)}
\end{aligned}
\]</span></p>
</div>
</div>
<div id="hw-1-introduction" class="section level1">
<h1>HW 1: Introduction</h1>
<div id="section" class="section level2">
<h2>3.3</h2>
<p>The Pareto <span class="math inline">\((a, b)\)</span> distribution has cdf <span class="math display">\[
F(x)=1-\left(\frac{b}{x}\right)^{a}, \quad x \geq b&gt;0, a&gt;0
\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2,2) distribution. Graph the density histogram of the sample with the Pareto(2,2) density superimposed for comparison.</p>
<div id="solution." class="section level3">
<h3>Solution.</h3>
<p>First we derive the probability inverse transformation <span class="math inline">\(F^{-1}(U) .\)</span> Denote <span class="math inline">\(y:=F(x),\)</span> then we have <span class="math display">\[
\begin{aligned}
&amp; y=1-\left(\frac{b}{x}\right)^{a} \\
\Longrightarrow &amp;\left(\frac{b}{x}\right)^{a}=1-y \\
\Longrightarrow &amp; \log (b)-1 / a \log (1-y)=\log (x) \\
\Longrightarrow &amp; x=\frac{b}{(1-y)^{1 / a}}
\end{aligned}.
\]</span> Since <span class="math inline">\(y=F(x),\)</span> then <span class="math inline">\(x=F^{-1}(y) .\)</span> Indeed, we have <span class="math inline">\(F^{-1}(U)=\frac{b}{(1-U)^{1 / a}}\)</span>.</p>
<p>Now we use the inverse transform method to simulate a random sample from the Pareto (2, 2) distribution.</p>
<p>Firstly we exhibit the algorithm below.</p>
<p><em>[Using Inverse Transform Method to simulate random samples from continuous distribution]</em> 1. Generate <span class="math inline">\(U \sim U(0,1)\)</span> 1. Return <span class="math inline">\(X=F^{-1}(U)\)</span></p>
<p>Based on the derivation above, we can easily apply the algorithm.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co">#Use the inverse transform method to simulate a random sample from the Pareto(2, 2) distribution</span></span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#Generate U ~ U(0, 1)</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>u =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#Return x = F^{-1}(u)</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>x =<span class="st"> </span><span class="kw">round</span>(<span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span>u), <span class="dv">3</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The random sample wanted is &quot;</span>, x, <span class="st">&quot;.&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; [1] &quot;The random sample wanted is 3.891.&quot;</span></span></code></pre></div>
<p>Now let’s generate a large amount of data to graph the density histogram and superimpose the theoretical density function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#&gt; Warning: package &#39;ggplot2&#39; was built under R version 4.0.3</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#generate data with amount == 5000</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>u =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">5000</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a>x =<span class="st"> </span><span class="kw">round</span>(<span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">-</span>u), <span class="dv">3</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a>x =<span class="st"> </span>x[x<span class="op">&lt;=</span><span class="dv">15</span>]</span>
<span id="cb3-7"><a href="#cb3-7"></a></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#gather the data into a dataframe</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>df =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sample =</span> x)</span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">#histogram</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> sample)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.5</span>, <span class="kw">aes</span>(<span class="dt">y=</span>..density..), <span class="dt">boundary =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Histogram of random samples&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Recall that <span class="math inline">\(F(x)=1-\left(\frac{x}{b}\right)^{-a},\)</span> we can easily get <span class="math inline">\(f(x)=\frac{a b^{a}}{x^{a+1}}=\frac{8}{x^{3}} .\)</span> Now we are ready to superimpose the theoretical density function onto the histogram.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">#density</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>funpareto =<span class="st"> </span><span class="cf">function</span>(x){<span class="dv">8</span><span class="op">/</span>(x<span class="op">^</span><span class="dv">3</span>)}</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#plot</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> sample)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.5</span>, <span class="kw">aes</span>(<span class="dt">y=</span>..density..), <span class="dt">boundary =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">stat_function</span>(<span class="dt">fun=</span>funpareto,<span class="dt">geom=</span><span class="st">&quot;line&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Histogram superimposed of theoretical density function&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-1" class="section level2">
<h2>3.9</h2>
<p>The rescaled Epanechnikov kernel [85] is a symmetric density function <span class="math display">\[
f_{e}(x)=\frac{3}{4}\left(1-x^{2}\right), \quad|x| \leq 1
\]</span></p>
<p>Devroye and Gyorfi <span class="math inline">\([71,\)</span> p. 236<span class="math inline">\(]\)</span> give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_{1}, U_{2}, U_{3} \sim\)</span> Uniform <span class="math inline">\((-1,1) .\)</span> If <span class="math inline">\(\left|U_{3}\right| \geq\)</span> <span class="math inline">\(\left|U_{2}\right|\)</span> and <span class="math inline">\(\left|U_{3}\right| \geq\left|U_{1}\right|,\)</span> deliver <span class="math inline">\(U_{2} ;\)</span> otherwise deliver <span class="math inline">\(U_{3} .\)</span> Write a function to generate random variates from <span class="math inline">\(f_{e},\)</span> and construct the histogram density estimate of a large simulated random sample.</p>
<div id="solution.-1" class="section level3">
<h3>Solution.</h3>
<p>We firstly summarize the algorithm below in a form of <strong>pseudo code</strong>.</p>
<p><em>[Simulation of The rescaled Epanechnikov kernel]</em></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>Generate i.i.d U1, U2, U3 <span class="op">~</span><span class="st"> </span><span class="kw">Uniform</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="cf">if</span>(<span class="op">|</span>U3<span class="op">|</span><span class="er">&gt;=|</span>U2<span class="op">|</span><span class="st"> </span>and <span class="op">|</span>U3<span class="op">|</span><span class="st"> </span><span class="er">&gt;=</span><span class="st"> </span><span class="er">|</span>U1<span class="op">|</span>){</span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="kw">return</span>(U2)</span>
<span id="cb5-4"><a href="#cb5-4"></a>}</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="cf">else</span>{</span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="kw">return</span>(U3)</span>
<span id="cb5-7"><a href="#cb5-7"></a>}</span></code></pre></div>
<p>Now we follow the algorithm to generate samples and plot.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#generate samples</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>n =<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>u =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dv">3</span><span class="op">*</span>n, <span class="dt">min =</span> <span class="dv">-1</span>, <span class="dt">max =</span> <span class="dv">1</span>), <span class="dt">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a>sample =<span class="st"> </span><span class="kw">apply</span>(u, <span class="dt">MARGIN =</span> <span class="dv">2</span>, <span class="dt">FUN =</span> <span class="cf">function</span>(x){<span class="kw">ifelse</span>(<span class="kw">abs</span>(x[<span class="dv">3</span>])<span class="op">&gt;</span><span class="kw">abs</span>(x[<span class="dv">2</span>]) <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(x[<span class="dv">3</span>])<span class="op">&gt;</span><span class="kw">abs</span>(x[<span class="dv">1</span>]), x[<span class="dv">2</span>], x[<span class="dv">3</span>])})</span>
<span id="cb6-6"><a href="#cb6-6"></a>df =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sample =</span> sample)</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#construct the histogram density estimate</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> sample)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.05</span>, <span class="kw">aes</span>(<span class="dt">y=</span>..density..), <span class="dt">boundary =</span> <span class="dv">-1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_freqpoly</span>(<span class="dt">binwidth =</span> <span class="fl">0.05</span>, <span class="kw">aes</span>(<span class="dt">y=</span>..density..)) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Histogram with density estimated&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-2" class="section level2">
<h2>3.10</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_{e}\)</span></p>
<div id="solution.-2" class="section level3">
<h3>Solution.</h3>
<p>Recall the algorithm,</p>
<p><em>[Simulation of The rescaled Epanechnikov kernel]</em></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>Generate i.i.d U1, U2, U3 <span class="op">~</span><span class="st"> </span><span class="kw">Uniform</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="cf">if</span>(<span class="op">|</span>U3<span class="op">|</span><span class="er">&gt;=|</span>U2<span class="op">|</span><span class="st"> </span>and <span class="op">|</span>U3<span class="op">|</span><span class="st"> </span><span class="er">&gt;=</span><span class="st"> </span><span class="er">|</span>U1<span class="op">|</span>){</span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="kw">return</span>(U2)</span>
<span id="cb7-4"><a href="#cb7-4"></a>}</span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="cf">else</span>{</span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="kw">return</span>(U3)</span>
<span id="cb7-7"><a href="#cb7-7"></a>}</span></code></pre></div>
<p>We now abstract the idea in this algorithm to ease our proof.</p>
<p>In the algorithm, if <span class="math inline">\(|U_3| = \max(\{|U_i|\}_{i\in\{1,2,3\}})\)</span>, then we deliver <span class="math inline">\(U_2\)</span>. Consider in this step whether the algorithm will change if we deliver <span class="math inline">\(U_1\)</span>. Actually the algorithm remains the same if we deliver <span class="math inline">\(U_1\)</span> instead of <span class="math inline">\(U_2\)</span> when <span class="math inline">\(|U_3| = \max(\{|U_i|\}_{i\in\{1,2,3\}})\)</span>. The reason is that given <span class="math inline">\(|U_3|\)</span> is the largest absolute value among the three, <span class="math inline">\(U_1\)</span> and <span class="math inline">\(U_2\)</span> are in a symmetric relationship. It is just fine to choose anyone of them.</p>
<p>And if (corresponding to the “else” in the algorithm) <span class="math inline">\(|U_3|\)</span> is not the largest value, then there must be one of <span class="math inline">\(U_1\)</span> and <span class="math inline">\(U_2\)</span> is in the symmetric relationship with <span class="math inline">\(U_3\)</span>. Though we do not know which is the one symmetrical to <span class="math inline">\(U_3\)</span>, still it is just fine to deliver <span class="math inline">\(U_3\)</span>.</p>
<p>To summarize, the algorithm aims to deliver randomly one of the two random variables which are not the largest in the three.</p>
<p>With the understanding of the idea of the algorithm, we can easily finish the proof.</p>
<p>Denote the result of the algorithm as <span class="math inline">\(U\)</span> and its density as <span class="math inline">\(f_U\)</span>. Also we care about <span class="math inline">\(|U|\)</span> whose density function is denoted as <span class="math inline">\(f_{|U|}\)</span>. Also <span class="math inline">\(\{|U|_{(1)}, |U|_{(2)}, |U|_{(3)}\}\)</span> represents the order statistics of <span class="math inline">\(\{|U_i|\}_{i\in\{1,2,3\}}\)</span> descendingly.</p>
<p><span class="math display">\[
\begin{split}
f_{|U|}(u) &amp;= 1/2 f_{|U|:|U| = |U|_{(2)}}(u) + 1/2 f_{|U|:|U| = |U|_{(3)}}(u)\\
&amp;= 3u(1-u)+3/2(1-u)^2\\
&amp;= 3/2(1-u^2), \quad u\in[0,1].
\end{split}
\]</span> Then we average the probability mass on <span class="math inline">\([0,1]\)</span> to <span class="math inline">\([-1,1]\)</span> symmetrically and we get to the final fomula</p>
<p><span class="math display">\[
f_e(u) = f_U(u) = 3/4(1-u^2), \quad u\in[-1,1].
\]</span></p>
</div>
</div>
<div id="section-3" class="section level2">
<h2>3.13</h2>
<p>It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[
F(y)=1-\left(\frac{\beta}{\beta+y}\right)^{r}, \quad y \geq 0
\]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise <span class="math inline">\(3.3 .)\)</span> Generate 1000 random observations from the mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta=2 .\)</span> Compare the empirical and theoretical (Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
<div id="solution.-3" class="section level3">
<h3>Solution.</h3>
<p>For the clarity in notations, we say</p>
<p><span class="math display">\[
y = F(x) = 1-\left(\frac{\beta}{\beta+x}\right)^{r}
\]</span> Then we have <span class="math display">\[
f(x) = \frac{r\beta^r}{(\beta+x)^{r+1}}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
x = F^{-1}(y) = \beta\left(\frac{1}{(1-y)^{1/r}} - 1\right)
\]</span></p>
<p>By the Algorithm  in , we have</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">#generate data</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>r =<span class="st"> </span><span class="dv">4</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>beta =<span class="st"> </span><span class="dv">2</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>u =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1000</span>)</span>
<span id="cb8-6"><a href="#cb8-6"></a>x =<span class="st"> </span>beta <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>r) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb8-7"><a href="#cb8-7"></a>x =<span class="st"> </span>x[x<span class="op">&lt;=</span><span class="dv">3</span>]</span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#density function</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>beta_r_pareto =<span class="st"> </span><span class="cf">function</span>(x, beta, r){r<span class="op">*</span>beta<span class="op">^</span>r<span class="op">/</span>(beta<span class="op">+</span>x)<span class="op">^</span>(r<span class="op">+</span><span class="dv">1</span>)}</span>
<span id="cb8-11"><a href="#cb8-11"></a></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co">#gather the data into a dataframe</span></span>
<span id="cb8-13"><a href="#cb8-13"></a>df =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sample =</span> x)</span>
<span id="cb8-14"><a href="#cb8-14"></a></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="co">#histogram</span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> sample)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="fl">0.05</span>, <span class="kw">aes</span>(<span class="dt">y=</span>..density..), <span class="dt">boundary =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun=</span><span class="cf">function</span>(x){<span class="kw">beta_r_pareto</span>(x, beta, r)},<span class="dt">geom=</span><span class="st">&quot;line&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Histogram superimposed of theoretical density function&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABFFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYzMzM6AAA6ADo6AGY6OgA6OmY6ZmY6ZpA6ZrY6kLY6kNtNTU1NTW5NTY5NbqtNjshZWVlmAABmOgBmOmZmkJBmkLZmkNtmtpBmtttmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQZgCQZjqQZmaQkGaQkLaQtpCQttuQ27aQ2/+rbk2rbm6rbo6ryKur5P+2ZgC2Zjq2kDq2tpC2ttu229u22/+2/9u2///Ijk3I///bkDrbkGbbtmbbtpDb27bb29vb/7bb/9vb///kq27k///r6+v/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///8lW+RjAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMfElEQVR4nO2dDXfbthWGIceep3brh511kre1dtY2m72ua6Zui9YtmVM1bRO3ktVZdvj//0dx8UGAJMgLkhAJi/c9JxEtvbwEHl+AEE0CLCFVivVdgNhFgBARIEQECBEBQkSAEBEgRAQIUQNAi71L8bqZHiV3FwdX5pP17y4DFata2aM22P2w+Oa/GTsUQaES1gGCAtKfbFtbALRiHJDYgkqEA+T+JHK5AZ2prbCARKS7zxgbnfJt/lvgzH46YWz/OThejtnoD7w0vEQLtvc8efkrbvyQZ/H46OWYb6zG7F1dEBVElQ3qwONzw/4MPoWYv36eqEjPuCcbI+8Vx9chze6iSPvPDCDtnfOii2rJSvBCvDoRRQ0BSMRk7EwB4gXlGvGyLsT7DAA9GLODK/XzGQf0DjeNvhineZ3oIBlA4BKR1jqmjPRaALJjWN6V8aqQZndZpP0TDSj1FgDtn6h9mwBiWhLQevzeFS/Doc5Odgqeg6vNdPQk+elCAILMurvgSSSMvMCnyUvYfz1WuZwGsQHxbvPuK7E/JMK3YxMJjmrHsL36+FZIvbspkv6tKG+hicF730C4IIAe/P5ZGluQ4jk7mq2gLqqEKum+/89fx+xQejZTaJ0XKSAVxAYkPpvvXfLmpMLLSPKodgzbq4+fhjS7yy1lSayyFgDBYTZTXtQQfRDkJ3v3uQYkjrQazRaQ06KqCoPMdAHoSB6eF073hjqIDUgUfwGopUYz/anog6wYxmuOn4Y0u0sMaSdteV2dNPhWQU7z357IJlwNiDeDd/7231dTNyAdJCAgHbJ/QFzf/YUfobyJgUsWR/ZBDkA6yFxnt2w2kO2qIolpgEVAxps2Gx3S7C6bmKJZ2cQ0oBBNbMXe5x3BV/woC3nucHTSEhAfqvLzar5yIpgJMmcfQhDRSb+fdtJP+Cn5wuRXEZDx6uOnIc3uvEinMrjC7eqkRSU0oEadtPs0z0MuSk/z8nhMGR2ATJCVPhNvpg/G6uy7sk8KbkDGmzvN65BijJYGlzJltQDJcZACFG6g+B70MifwfWadGSh+NE07aTEqe6LPSrkmlgZJvuFDv9eyD4JRoIgEMR+cVjWxrNcMFEVIvbvolvb/ZwaKqdcAgkq8bgWonopfSPz3dHynDOCtpy0CWo9/wbNrnv5q6mrnAZk+oJl2HpDVBzTS7gPaCREgRAQIEQFCRIAQESBE9QEtjeztEt1bCwFCLM0BDUyUQSUWAoRYCBBiIUCIhQAhFgKEWAgQYgkCaDKZdF3uziwECLEQIMRCgBALAUIsBAixECDEQoAQCwFCLAQIsRAgxOIB6ObR8fG52Lp9fPzBjwQop9s/PU1u/viUb7358jz54bcEKKdrQPICUuj2z18nNx9/TYDcWcTb2ic/qq1fclkfs4lQZYj7rkpAb778FF6uP9CAQBZvBajLX2xnFh9At48FHyuDCJCtm0fnClRZHzRsQCkf0dLcZzE2ZEA/HIPOIXVKx0GDBlQmKxwBIkAEqMxCgBBLGECSUJfl7sxCgBALAUIsBAixECDEQoAQSyBAglCX5e7MQoAQCwFCLAQIsRAgxEKAEEtzQJYmklCbENGrbQYBoC5/sZ1ZCBBiIUCIhQAhlmCAOKEuy92ZhQAhFgKEWAgQYiFAiIUAIZZwgCasy3J3ZiFAiIUAIRYChFgIEGIJCKiSUJy197AQIMRCgBCLFyB9ayvcrvgb9532gwZ0ram8OLfetcINHNCLh/+SGfTmH0+tt61wCtCyglCctfew1Glit4+P1YNRuWc1FCAVZLKTf9/wAQQPRZkssnhnM8j5F7I408PDUgeQUNoPWeEIEAHyAgSPQ735Z/lpfikJDRQQ/OPjoIfpicwKN3hATlnhCBABCgRIECJABIgAESBvCwFCLIEBASECVAZIfdsgQIMHtJmqZd0IUFkGzT3WKrLCWYA4oSEAEis1suoFwaxwQwQkEVWt2WyFGyKghVhceF7R0KxwgwMES6bJlUcrUsgKZwNaup/aiLP2HhYXoM3UZzl0K9zwAKHpk5UBlMj5utSbnrvfC9UHZPF2ZlA2keJMDw9LEZBZBLx6uUArXAbQku04oDSDEFnhhgbIT1a4QQHi6QNDRMaqh4klgITYTgNql0EEyA+Q1eD6q1oYixOQbGbIMMgKNzhA80NYK33R4DSfJdRv1cJYXIB4AsES600GioMBBKvDEyCx5QB0d3G0Gs2goTUEpAn1W7UwFhegZD3mXzOqrgUNHZCXrHAEqC6g4syTcdbew+IExJtYm68aOw8IzvGUQXrLAajF5Y4soX6rFsbizqAcIH0bcMXCI4MClB8i6odZqhYecRLqt2phLO4mlrkelD7MUrXwyKAAFaSf1ShbeMQFaNfm7PK90965rkYZoH5/92EsbkALxs4W5qtGIYN8AGXnqoiz9h4WJ6D5wSt5xSMLqFYftMuAxOWOM+tcpqiULzxCgGTq1BgHCUL9Vi2MxdnEFtDE4JpZlaxwgwOUrGAYVM1n2IB8ZIUrAWQTirP2HpatA5rI4VCctfewFADp7xntrgdJWTcFx1l7D4szgxaABrvoYYUbGqAWN1Dl25jk1E/Vwli2C8hcFoqz9h4WFyDdxNqOg3YXkBwHIdddrXDlgNLLQnHW3sPiBuQjKxwBIkBbA6Svm8VZew8LAUIsWwekLgvFWXsPCwFCLM0BWaoENGkVOhptL4PkRY8408PD0gEgQSjO2ntYCBBi6QIQXPWIs/YeFgKEWDoBxAnFWXsPSzeAlizO2ntYCBBi6QhQ1Ty426paGAsBQixdAUpwQgSo46qFsXQGCG9kQweEEiJAHVctjKULQCCwM3uH7VctjKVLQIYQAXIDSgntFiBzZyKy8AgOyD1txZaqFsaCA7Ke0EAWHvEA5JyVYUtVC2PBAZm7o7GFRxBJ532bkxsHZO6vxxYewZJIOllyL2enKgdkntDAFh7xyiB946J+p9f08LDggLJPaFStq+EHSN2XtzuAsk9oBAAkp1rcHUDmCQ1s4RFfQEvH1BX91N7DggNS4yCPhUe8AS2LEw/0U3sPiwegElnhagMqPjbeT+09LD0BKjwV3U/tPSwdAspyKs5oSoAygHLPtPZTew9L94BS5ddfJ0AFQr3X3sPSJ6AcIQJUUPYyNQEqAlrG/9Rmz4CWLPZHyvoGBIgIUCWg9EI1ASoDNGER3yncNyC1xaK9jTESQPHexhgJIEiiqnJPeuummgOy1BRQdldWUYZJ738G6T+DJsmSld4Ach8zKFv8IIDgfOb4i+KSAKWAJhN3Fg0UUFYS0EQOrXOJRIAsQPDtg+USiQBlAImXDKJJ7pq/u6caFqCljYgAFSQCp03NkLE/JkApJALkAmRAMEaAKgHBCFIlEgFyAxKSU6sRoByg/CcCkjosASqJrnOJAJVFF4dNJzTMVi27+5ABmVtFDKihAfI2CzFmJZUTUG6HJdqT7RagpckgloG1VUDmWY2a80l3LhtQdpxZUAFXNlIdQOZZjVrravShMkCODHIw04LP6wAy90nXnNO+V2VLtcz3+FWlBkh1AJk77UvX1RiCfJ7VKF1XI84/+YWx4IBcGUSALHn0QXFWLYwFB2Se1ShdVyPOqoWx4ICsZzXKxkFxVi2MxQNQifotd2cWAoRYCBBiIUCIpTkgS2FG1XFHIUBIFAKERCFASJTdmPR5iyJAiAgQIgKEiAAhag4o8xW/haz5QZrHeKTm72mla2uerVSNAWX/1NFc145C1RVc7oQ5fNpJTMJRqFFjQLnJYZoqXZK8ja6hWi/ap5ArnRsDyk0v1FwhmliShClLyAzK/qmjhcIAgsvCrXXz6GGhQjuSQbePA/BJXHnYdx8U6iwWogMCFXqyFmexT4OcxUIACsPH3WnsxDgIZgoNMBDKTLSlRSNpRAQIEQFCRIAQESBEBAjRPQS0fmvW4dEIECIChCgyQOuxXK5cvB5xFl/wjSP46Yz/8DljB1cC0N0FY7D2+/YVFyCRHOvx2WbKIS32LtdjDmQBVMQPe5d3F4dggpdkwd/eviID9LbMiv9D1TkIzkoAs37gr2/NVpA9guLWFRegZM7YodhY8SY2msmMUv+JV06Fvy7kvfFHHZQoMkBAgHcum+loljJxAeqkdQlFB0gwWAGAVT6DRBN7+xKa2KizE1lcgETfogCsxwVAVifNCXZDKS5AqusRfdHo76I12U3sc9FD6dN8N1kUGaAqdTtA1CJAiAgQonsEqB8RIEQECBEBQkSAEBEgRAQI0c+SBNxr3jqDPQAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
</div>
</div>
<div id="hw-2-random-number-generation" class="section level1">
<h1>HW 2: Random number generation</h1>
<div id="section-4" class="section level2">
<h2>5.1</h2>
<p><strong>Compute a Monte Carlo estimate of</strong> <span class="math display">\[
\int_{0}^{\pi / 3} \sin t d t
\]</span></p>
<p><strong>and compare your estimate with the exact value of the integral. </strong></p>
<p><span class="math inline">\(\quad\)</span></p>
<p><strong>Solution.</strong></p>
<p><span class="math display">\[
\int_{0}^{\pi / 3} \sin t d t = \frac{\pi}{3} \mathbb{E}\sin(X),\quad X\sim U(0,\pi/3)
\]</span></p>
<p><em>[Algorithm Flowchart]</em></p>
<ol style="list-style-type: decimal">
<li><p>Generate a large amount of <span class="math inline">\(X_i\sim U(0,\pi/3),1\leq i \leq n\)</span>.</p></li>
<li><p>Calculate <span class="math inline">\(\sin(X_i)\)</span>.</p></li>
<li><p>Calculate the average <span class="math inline">\(\overline{\sin(X_i)} = \frac{1}{n}\sum_{i=1}^n \sin(X_i)\)</span>.</p></li>
<li><p>The integration approximates <span class="math inline">\(\frac{\pi}{3}\overline{\sin(X_i)}\)</span>.</p></li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>n =<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>x =<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> pi<span class="op">/</span><span class="dv">3</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a>result =<span class="st"> </span><span class="kw">round</span>(pi<span class="op">/</span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(x)), <span class="dv">4</span>)</span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The approximated integation is &quot;</span>, result, <span class="st">&quot;.&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">#&gt; [1] &quot;The approximated integation is 0.5004.&quot;</span></span></code></pre></div>
<p>The result is rather close to the theoretical value which can be calculated as</p>
<p><span class="math display">\[
\int_{0}^{\pi / 3} \sin t d t = \left.(-\cos t)\right|_{0}^{\frac{\pi}{3}} = 0.5.
\]</span></p>
</div>
<div id="section-5" class="section level2">
<h2>5.7</h2>
<p><strong>Refer to Exercise <span class="math inline">\(5.6\)</span>. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise <span class="math inline">\(5.6\)</span>. </strong></p>
<p><span class="math inline">\(\quad\)</span></p>
<p><strong>Solution. </strong></p>
<p>For the clarity, it is necessary to recall the content in Exercise <span class="math inline">\(5.6\)</span>.</p>
<p>We have Monte Carlo integration as</p>
<p><span class="math display">\[
\theta=\int_{0}^{1} e^{x} d x.
\]</span></p>
<p><span class="math inline">\(\quad\)</span></p>
<p><em>[Simple Monte Carlo Method Flowchart]</em></p>
<ol style="list-style-type: decimal">
<li><p>Generate a large amount of <span class="math inline">\(U_i\sim U(0, 1),1\leq i \leq n\)</span>.</p></li>
<li><p>Calculate <span class="math inline">\(\exp(U_i)\)</span>.</p></li>
<li><p>Calculate the average <span class="math inline">\(\overline{\exp(U_i)} = \frac{1}{n}\sum_{i=1}^n \exp(U_i)\)</span>.</p></li>
<li><p>The integration approximates <span class="math inline">\(\overline{\exp(U_i)}\)</span>.</p></li>
</ol>
<p><em>[Antithetic Variate Monte Carlo Method Flowchart]</em></p>
<ol style="list-style-type: decimal">
<li><p>Generate a large amount of <span class="math inline">\(U_i\sim U(0, 1),1\leq i \leq n/2\)</span>.</p></li>
<li><p>Calculate <span class="math inline">\(\exp(U_i)\)</span> and <span class="math inline">\(\exp(1-U_i)\)</span>.</p></li>
<li><p>Calculate the average <span class="math inline">\(\overline{\exp(U_i)} = \frac{2}{n}\sum_{i=1}^{n/2} \exp(U_i)\)</span> and <span class="math inline">\(\overline{\exp(1-U_i)} = \frac{2}{n}\sum_{i=1}^{n/2} \exp(1-U_i)\)</span>.</p></li>
<li><p>The integration approximates <span class="math inline">\(\frac{\overline{\exp(U_i)}+\overline{\exp(1-U_i)}}{2}\)</span>.</p></li>
</ol>
<p>Theoretically, the origin variance is</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
Var(\exp(U)) &amp;= \int_0^1 \exp(2u)\mathrm{d}u - \left(\int_0^1\exp(u)\mathrm{d}u\right)^2\\
 &amp;= \frac{4e-e^2-3}{2} \approx 0.242
\end{split}
\end{equation*}\]</span></p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
Var(\overline{\exp(U_i)}) &amp;= \frac{1}{n} Var(\exp(U))
\end{split}
\end{equation*}\]</span></p>
<p>The variance of antithetic variate is</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
Var\left(\frac{\exp(U)+\exp(1-U)}{2}\right) &amp;=\frac{1}{4} \int_0^1 \left(\exp(u)+\exp(1-u) \right)^2\mathrm{d}u - \left(\int_0^1\exp(u)\mathrm{d}u\right)^2\\
 &amp;= \frac{1}{4} \left(2\int_0^1 \exp(2u)\mathrm{d}u+ 2\int_0^1 e \mathrm{d}u\right) - \left(\int_0^1\exp(u)\mathrm{d}u\right)^2\\
 &amp;= \frac{1}{4} (e^2-1+2e) - (e-1)^2\\
 &amp; = \frac{10e-3e^2-5}{4} \approx 3.912\times 10^{-3}
\end{split} 
\end{equation*}\]</span></p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
Var(\frac{\overline{\exp(U_i)}+\overline{\exp(1-U_i)}}{2}) &amp;= \frac{2}{n} Var\left(\frac{\exp(U)+\exp(1-U)}{2}\right)
\end{split}
\end{equation*}\]</span></p>
<p>So the theoretical variance reduction is calculated below</p>
<p><span class="math display">\[
\text{Variance Reduction} = \frac{0.242-2\times3.912\times 10^{-3}}{0.242} \times 100\%\approx 96.77\%.
\]</span></p>
<p>Now we move to the simulation stage.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co">#Simple Monte Carlo Method </span></span>
<span id="cb10-2"><a href="#cb10-2"></a>n =<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">6</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>u =<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb10-4"><a href="#cb10-4"></a>x1 =<span class="st"> </span><span class="kw">exp</span>(u)</span>
<span id="cb10-5"><a href="#cb10-5"></a>m1 =<span class="st"> </span><span class="kw">mean</span>(x1)</span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The estimation of the integration under Simple Monte Carlo Method is &quot;</span>, <span class="kw">round</span>(m1, <span class="dv">3</span>), <span class="st">&quot;.&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt; [1] &quot;The estimation of the integration under Simple Monte Carlo Method is 1.718.&quot;</span></span>
<span id="cb10-8"><a href="#cb10-8"></a></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#Antithetic Variate Monte Carlo Method </span></span>
<span id="cb10-10"><a href="#cb10-10"></a>u =<span class="st"> </span><span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb10-11"><a href="#cb10-11"></a>x2 =<span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>(<span class="kw">exp</span>(u)<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>u))</span>
<span id="cb10-12"><a href="#cb10-12"></a>m2 =<span class="st"> </span><span class="kw">mean</span>(x2)</span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The estimation of the integration under Antithetic Variate Monte Carlo Method is &quot;</span>, <span class="kw">round</span>(m2, <span class="dv">3</span>), <span class="st">&quot;.&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">#&gt; [1] &quot;The estimation of the integration under Antithetic Variate Monte Carlo Method is 1.718.&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>mc1 =<span class="st"> </span>mc2 =<span class="st"> </span><span class="kw">c</span>()</span>
<span id="cb11-2"><a href="#cb11-2"></a>n =<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">4</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>) {</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#Simple Monte Carlo Method </span></span>
<span id="cb11-5"><a href="#cb11-5"></a>u =<span class="st"> </span><span class="kw">runif</span>(n)</span>
<span id="cb11-6"><a href="#cb11-6"></a>x1 =<span class="st"> </span><span class="kw">exp</span>(u)</span>
<span id="cb11-7"><a href="#cb11-7"></a>m1 =<span class="st"> </span><span class="kw">mean</span>(x1)</span>
<span id="cb11-8"><a href="#cb11-8"></a>mc1 =<span class="st"> </span><span class="kw">c</span>(mc1,m1)</span>
<span id="cb11-9"><a href="#cb11-9"></a></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#Antithetic Variate Monte Carlo Method </span></span>
<span id="cb11-11"><a href="#cb11-11"></a>u =<span class="st"> </span><span class="kw">runif</span>(n<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb11-12"><a href="#cb11-12"></a>x2 =<span class="st"> </span><span class="fl">0.5</span><span class="op">*</span>(<span class="kw">exp</span>(u)<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>u))</span>
<span id="cb11-13"><a href="#cb11-13"></a>m2 =<span class="st"> </span><span class="kw">mean</span>(x2)</span>
<span id="cb11-14"><a href="#cb11-14"></a>mc2 =<span class="st"> </span><span class="kw">c</span>(mc2,m2)</span>
<span id="cb11-15"><a href="#cb11-15"></a>}</span>
<span id="cb11-16"><a href="#cb11-16"></a></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="co">#Empirical Variance Reduction</span></span>
<span id="cb11-18"><a href="#cb11-18"></a>vr =<span class="st"> </span><span class="dv">100</span><span class="op">*</span>(<span class="kw">var</span>(mc1)<span class="op">-</span><span class="kw">var</span>(mc2))<span class="op">/</span><span class="kw">var</span>(mc1)</span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The empirical variance reduction is &quot;</span>, <span class="kw">round</span>(vr,<span class="dv">2</span>), <span class="st">&quot;%.&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="co">#&gt; [1] &quot;The empirical variance reduction is 96.99%.&quot;</span></span></code></pre></div>
</div>
<div id="section-6" class="section level2">
<h2>5.11</h2>
<p><strong>If <span class="math inline">\(\hat{\theta}_{1}\)</span> and <span class="math inline">\(\hat{\theta}_{2}\)</span> are unbiased estimators of <span class="math inline">\(\theta,\)</span> and <span class="math inline">\(\hat{\theta}_{1}\)</span> and <span class="math inline">\(\hat{\theta}_{2}\)</span> are antithetic, we derived that <span class="math inline">\(c^{\ast}=1 / 2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat{\theta}_{c}=c \hat{\theta}_{2}+(1-c) \hat{\theta}_{2} .\)</span> Derive <span class="math inline">\(c^{\ast}\)</span> for the general case. That is, if <span class="math inline">\(\hat{\theta}_{1}\)</span> and <span class="math inline">\(\hat{\theta}_{2}\)</span> are any two unbiased estimators of <span class="math inline">\(\theta,\)</span> find the value <span class="math inline">\(c^{*}\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat{\theta}_{c}=c \hat{\theta}_{2}+(1-c) \hat{\theta}_{2}\)</span> in equation below. (<span class="math inline">\(c^{*}\)</span> will be a function of the variances and the covariance of the estimators.)</strong></p>
<p><span class="math display">\[\operatorname{Var}\left(c \hat{\theta}_{1}+(1-c) \hat{\theta}_{2}\right)=\operatorname{Var}\left(\hat{\theta}_{2}\right)+c^{2} \operatorname{Var}\left(\hat{\theta}_{1}-\hat{\theta}_{2}\right)+2 c \operatorname{Cov}\left(\hat{\theta}_{2}, \hat{\theta}_{1}-\hat{\theta}_{2}\right)\]</span></p>
<p><span class="math inline">\(\quad\)</span></p>
<p><strong>Solution. </strong></p>
<p>Define <span class="math inline">\(f(c) = \operatorname{Var}\left(c \hat{\theta}_{1}+(1-c) \hat{\theta}_{2}\right)\)</span>.</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
f^{(1)}(c) &amp;= 2c \operatorname{Var}\left(\hat{\theta}_{1}-\hat{\theta}_{2}\right)+2  \operatorname{Cov}\left(\hat{\theta}_{2}, \hat{\theta}_{1}-\hat{\theta}_{2}\right)\\
f^{(2)}(c) &amp;= 2 \operatorname{Var}\left(\hat{\theta}_{1}-\hat{\theta}_{2}\right) &gt; 0\\
\end{split}
\end{equation*}\]</span></p>
<p>So let the first-order derivative equals to <span class="math inline">\(0\)</span>.</p>
<p><span class="math display">\[\begin{equation*}
\begin{split}
f^{(1)}(c) &amp;= 2c \operatorname{Var}\left(\hat{\theta}_{1}-\hat{\theta}_{2}\right)+2  \operatorname{Cov}\left(\hat{\theta}_{2}, \hat{\theta}_{1}-\hat{\theta}_{2}\right)=0\\
\implies c^\ast &amp;= -\frac{ \operatorname{Cov}\left(\hat{\theta}_{2}, \hat{\theta}_{1}-\hat{\theta}_{2}\right)}{\operatorname{Var}\left(\hat{\theta}_{1}-\hat{\theta}_{2}\right)}
\end{split}
\end{equation*}\]</span></p>
</div>
</div>
<div id="hw-3-monte-carlo-integration" class="section level1">
<h1>HW 3: Monte Carlo integration</h1>
<div id="section-7" class="section level2">
<h2>5.13</h2>
<p><strong>Find two importance functions <span class="math inline">\(f_{1}\)</span> and <span class="math inline">\(f_{2}\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are ‘close’ to</strong> <span class="math display">\[
g(x)=\frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2}, \quad x&gt;1
\]</span> <strong>Which of your two importance functions should produce the smaller variance in estimating</strong> <span class="math display">\[
\int_{1}^{\infty} \frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2} d x
\]</span> <strong>by importance sampling? Explain.</strong></p>
<div id="solution.-4" class="section level3">
<h3>Solution.</h3>
<p>Plot the g(x) firstly and imagine the functions with similar shape.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb12-2"><a href="#cb12-2"></a>g_sc_hw3 =<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb12-3"><a href="#cb12-3"></a>  x<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">dnorm</span>(x)</span>
<span id="cb12-4"><a href="#cb12-4"></a>}</span>
<span id="cb12-5"><a href="#cb12-5"></a></span>
<span id="cb12-6"><a href="#cb12-6"></a>base &lt;-<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">xlim</span>(<span class="dv">1</span>,<span class="dv">5</span>)</span>
<span id="cb12-7"><a href="#cb12-7"></a>base <span class="op">+</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="st">  </span><span class="kw">geom_function</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;g(x)&quot;</span>), <span class="dt">fun =</span> g_sc_hw3)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can briefly see two characteristic from the plot of g(x).</p>
<ol style="list-style-type: decimal">
<li><p>Most part of g(x) decays quickly.</p></li>
<li><p>g(x) appears a peak around <span class="math inline">\(x = 1.5\)</span>.</p></li>
</ol>
<p>By our observation, we might choose Exponential Distribution and Normal Distribution with mean <span class="math inline">\(1.5\)</span>. Note that both distributions are truncated before <span class="math inline">\(x=1\)</span>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>base <span class="op">+</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="st">  </span><span class="kw">geom_function</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;g(x)&quot;</span>), <span class="dt">fun =</span> g_sc_hw3) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="st">  </span><span class="kw">geom_function</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;density of normal&quot;</span>), <span class="dt">fun =</span> <span class="cf">function</span>(x){<span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="fl">1.5</span>)}) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="st">  </span><span class="kw">geom_function</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;density of exponential&quot;</span>), <span class="dt">fun =</span> dexp)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>So</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
\text{Integration} &amp;= \int_{1}^{\infty} \frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2} d x\\
&amp; = \int_1^\infty \frac{g(x)}{f(x)} f(x) dx\\
&amp;=\mathbb{E}_f \left[\frac{g(X)}{f(X)}\right], X\sim f.
\end{split}
\end{equation}\]</span></p>
<p>In the case of choosing exponential distribution, we have</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
f_1 (x) &amp;= \exp\{1-x\}\mathbb{I}(x&gt;1)
\end{split}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>m =<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">5</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>x =<span class="st"> </span><span class="kw">rexp</span>(m)</span>
<span id="cb14-3"><a href="#cb14-3"></a>x =<span class="st"> </span>x[x<span class="op">&gt;</span><span class="dv">1</span>]</span>
<span id="cb14-4"><a href="#cb14-4"></a>y =<span class="st"> </span><span class="kw">g_sc_hw3</span>(x)<span class="op">/</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>x)</span>
<span id="cb14-5"><a href="#cb14-5"></a>res =<span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The integration using truncated exponential function as the important function is approximated as &quot;</span>, <span class="kw">round</span>(res,<span class="dv">3</span>), <span class="st">&quot;.&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#&gt; [1] &quot;The integration using truncated exponential function as the important function is approximated as 0.401.&quot;</span></span></code></pre></div>
<p>In the case of choosing normal distribution, we have</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
f_2 (x) &amp;= \frac{\phi(x-1.5)}{1-\Phi(-0.5)}\mathbb{I}(x&gt;1)
\end{split}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\phi\)</span> is the standard normal density, <span class="math inline">\(\Phi\)</span> is the standard normal cumulative distribution.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>m =<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">5</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(m, <span class="dt">mean =</span> <span class="fl">1.5</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a>x =<span class="st"> </span>x[x<span class="op">&gt;</span><span class="dv">1</span>]</span>
<span id="cb15-4"><a href="#cb15-4"></a>y =<span class="st"> </span><span class="kw">g_sc_hw3</span>(x)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(<span class="op">-</span><span class="fl">0.5</span>))<span class="op">/</span><span class="kw">dnorm</span>(x<span class="fl">-1.5</span>)</span>
<span id="cb15-5"><a href="#cb15-5"></a>res =<span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The integration using truncated normal function as the important function is approximated as &quot;</span>, <span class="kw">round</span>(res,<span class="dv">3</span>), <span class="st">&quot;.&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">#&gt; [1] &quot;The integration using truncated normal function as the important function is approximated as 0.401.&quot;</span></span></code></pre></div>
<p>Recall the plot, we can tell that the normal case is more similar to <span class="math inline">\(g(x)\)</span>, which also means that their ratio is closer to a constant. We can guess that under the normal case, the variance is smaller.</p>
<p>Indeed, we can show the variance with simulated data as well.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>est =<span class="st"> </span>est.sd =<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a></span>
<span id="cb16-3"><a href="#cb16-3"></a>m =<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">5</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>x =<span class="st"> </span><span class="kw">rexp</span>(m)</span>
<span id="cb16-5"><a href="#cb16-5"></a>x =<span class="st"> </span>x[x<span class="op">&gt;</span><span class="dv">1</span>]</span>
<span id="cb16-6"><a href="#cb16-6"></a>y1 =<span class="st"> </span><span class="kw">g_sc_hw3</span>(x)<span class="op">/</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>x)</span>
<span id="cb16-7"><a href="#cb16-7"></a></span>
<span id="cb16-8"><a href="#cb16-8"></a></span>
<span id="cb16-9"><a href="#cb16-9"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(m, <span class="dt">mean =</span> <span class="fl">1.5</span>)</span>
<span id="cb16-10"><a href="#cb16-10"></a>x =<span class="st"> </span>x[x<span class="op">&gt;</span><span class="dv">1</span>]</span>
<span id="cb16-11"><a href="#cb16-11"></a>y2 =<span class="st"> </span><span class="kw">g_sc_hw3</span>(x)<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(<span class="op">-</span><span class="fl">0.5</span>))<span class="op">/</span><span class="kw">dnorm</span>(x<span class="fl">-1.5</span>)</span>
<span id="cb16-12"><a href="#cb16-12"></a></span>
<span id="cb16-13"><a href="#cb16-13"></a>n =<span class="st"> </span><span class="kw">min</span>(<span class="kw">length</span>(y1), <span class="kw">length</span>(y2))</span>
<span id="cb16-14"><a href="#cb16-14"></a>y1 =<span class="st"> </span>y1[<span class="dv">1</span><span class="op">:</span>n]</span>
<span id="cb16-15"><a href="#cb16-15"></a>y2 =<span class="st"> </span>y2[<span class="dv">1</span><span class="op">:</span>n]</span>
<span id="cb16-16"><a href="#cb16-16"></a></span>
<span id="cb16-17"><a href="#cb16-17"></a>est[<span class="dv">1</span>] =<span class="st"> </span><span class="kw">mean</span>(y1)</span>
<span id="cb16-18"><a href="#cb16-18"></a>est.sd[<span class="dv">1</span>] =<span class="st"> </span><span class="kw">sd</span>(y1)</span>
<span id="cb16-19"><a href="#cb16-19"></a>est[<span class="dv">2</span>] =<span class="st"> </span><span class="kw">mean</span>(y2)</span>
<span id="cb16-20"><a href="#cb16-20"></a>est.sd[<span class="dv">2</span>] =<span class="st"> </span><span class="kw">sd</span>(y2)</span>
<span id="cb16-21"><a href="#cb16-21"></a></span>
<span id="cb16-22"><a href="#cb16-22"></a>res &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="dt">est=</span><span class="kw">round</span>(est,<span class="dv">3</span>), <span class="dt">sd=</span><span class="kw">round</span>(est.sd,<span class="dv">3</span>))</span>
<span id="cb16-23"><a href="#cb16-23"></a>  <span class="kw">colnames</span>(res) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&#39;f&#39;</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</span>
<span id="cb16-24"><a href="#cb16-24"></a>  knitr<span class="op">::</span><span class="kw">kable</span>(res,<span class="dt">align=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">f1</th>
<th align="center">f2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">est</td>
<td align="center">0.401</td>
<td align="center">0.400</td>
</tr>
<tr class="even">
<td align="left">sd</td>
<td align="center">0.157</td>
<td align="center">0.117</td>
</tr>
</tbody>
</table>
<p>From the table we can see in the <span class="math inline">\(f_2\)</span> case the standard error is smaller.</p>
</div>
</div>
<div id="section-8" class="section level2">
<h2>5.15</h2>
<p><strong>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</strong></p>
<div id="solution.-5" class="section level3">
<h3>Solution.</h3>
<p>We do the theoretical adjustments firstly,</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
\int_{0}^{1} \frac{e^{-x}}{1+x^{2}} d x &amp; = \sum_{j = 0}^4 \int_{\frac{j}{5}}^{\frac{j+1}{5}} \frac{e^{-x}}{1+x^{2}} d x\\
\end{split}
\end{equation}\]</span></p>
<p>For the clarity in notations, we define <span class="math display">\[
g(x)= \frac{e^{-x}}{1+x^{2}}
\]</span></p>
<p><span class="math display">\[
f(x) = \frac{e^{-x}}{1-e^{-1}}
\]</span></p>
<p>So now the above can be written as <span class="math display">\[\begin{equation}
\begin{split}
\text{Integration} = \sum_{j = 0}^4 \int_{\frac{j}{5}}^{\frac{j+1}{5}} \frac{g(x)}{f(x)}f(x) d x
\end{split}
\end{equation}\]</span></p>
<p>Currently the <span class="math inline">\(f(x)\)</span> is not satisfying enought since it is not a probability density function in <span class="math inline">\([\frac{j}{5}, \frac{j+1}{5}], \forall j\in\{1,\cdots,5\}\)</span>. But we can fix this respectively with the intervals.</p>
<p>Indeed, with an arbitary <span class="math inline">\(j\)</span> fixed,</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
 \int_{\frac{j}{5}}^{\frac{j+1}{5}} f(x) d x &amp;= \int_{\frac{j}{5}}^{\frac{j+1}{5}} \frac{e^{-x}}{1-e^{-1}} d x \\
 &amp; = \frac{e^{-j/5}-e^{-(j+1)/5}}{1-e^{-1}}
\end{split}
\end{equation}\]</span></p>
<p>Then we have adjusted version of <span class="math inline">\(f(x)\)</span> on each interval as <span class="math display">\[\begin{equation}
\begin{split}
f_j(x) &amp;= f(x)\times \frac{1-e^{-1}}{e^{-j/5}-e^{-(j+1)/5}}\\
&amp;= \frac{e^{-x}}{e^{-j/5}-e^{-(j+1)/5}}
\end{split}
\end{equation}\]</span></p>
<p>By the way, it is easy to give the corresponding cumulative distribution along with their inverse function on each interval</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
F_j(x) 
&amp;= \frac{e^{-j/5}-e^{-x}}{e^{-j/5}-e^{-(j+1)/5}}
\end{split}
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
\begin{split}
F_j^{-1}(y) 
&amp;= -\log\left(e^{-j/5}-y\left(e^{-j/5}-e^{-(j+1)/5}\right)\right)
\end{split}
\end{equation}\]</span></p>
<p>Also we have the adjusted integration as</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
\text{Integration} &amp;= \sum_{j = 0}^4 \int_{\frac{j}{5}}^{\frac{j+1}{5}} \frac{g(x)}{f_j(x)}f_j(x) d x\\
&amp;=\sum_{j = 0}^4 \mathbb{E}_{f_j}\left[\frac{g(X)}{f_j(X)}\right]\\
&amp;\approx \sum_{j = 0}^4 \frac{1}{m_j} \sum_{i=1}^{m_j}\frac{g(x_i^j)}{f_j(x_i^j)}
\end{split}
\end{equation}\]</span></p>
<p>Now we finish the theoretical adjustments and are ready to move to the simulation stage.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co">#g(x)/f_j(z)</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>g_divide_fj =<span class="st"> </span><span class="cf">function</span>(x, j){</span>
<span id="cb17-3"><a href="#cb17-3"></a>  (<span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>)<span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>(j<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">5</span>))<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a>}</span>
<span id="cb17-5"><a href="#cb17-5"></a></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co">#Total amount of samples</span></span>
<span id="cb17-7"><a href="#cb17-7"></a>m =<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">4</span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co">#Amount of samples in each interval</span></span>
<span id="cb17-9"><a href="#cb17-9"></a>mj =<span class="st"> </span>m<span class="op">/</span><span class="dv">5</span></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="co">#Data Matrix</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>data.mat =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> mj, <span class="dt">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb17-13"><a href="#cb17-13"></a>  u =<span class="st"> </span><span class="kw">runif</span>(mj)</span>
<span id="cb17-14"><a href="#cb17-14"></a>  x =<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>) <span class="op">-</span><span class="st"> </span>u<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>) <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(j<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb17-15"><a href="#cb17-15"></a>  data.mat[,(j<span class="op">+</span><span class="dv">1</span>)] =<span class="st"> </span><span class="kw">g_divide_fj</span>(x, j)</span>
<span id="cb17-16"><a href="#cb17-16"></a>}</span>
<span id="cb17-17"><a href="#cb17-17"></a></span>
<span id="cb17-18"><a href="#cb17-18"></a>result =<span class="st"> </span><span class="kw">sum</span>(<span class="kw">colMeans</span>(data.mat))</span>
<span id="cb17-19"><a href="#cb17-19"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The estimation of the wanted integration using straitified method is &quot;</span>, <span class="kw">round</span>(result, <span class="dv">3</span>), <span class="st">&quot;.&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb17-20"><a href="#cb17-20"></a><span class="co">#&gt; [1] &quot;The estimation of the wanted integration using straitified method is 0.525.&quot;</span></span></code></pre></div>
<p>Now we consider the standard error of our estimation. Firstly, we define a statistics <span class="math inline">\(T\)</span></p>
<p><span class="math display">\[
T = \sum_{j = 0}^4 \frac{1}{m_j} \sum_{i=1}^{m_j}\frac{g(X_i^j)}{f_j(X_i^j)}, X_i^j\sim f_i
\]</span> So</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>n =<span class="st"> </span><span class="dv">10</span><span class="op">^</span><span class="dv">3</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>result.vec =<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb18-4"><a href="#cb18-4"></a>  data.mat =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> mj, <span class="dt">ncol =</span> <span class="dv">5</span>)</span>
<span id="cb18-5"><a href="#cb18-5"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb18-6"><a href="#cb18-6"></a>    u =<span class="st"> </span><span class="kw">runif</span>(mj)</span>
<span id="cb18-7"><a href="#cb18-7"></a>    x =<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>) <span class="op">-</span><span class="st"> </span>u<span class="op">*</span>(<span class="kw">exp</span>(<span class="op">-</span>j<span class="op">/</span><span class="dv">5</span>) <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>(j<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">5</span>)))</span>
<span id="cb18-8"><a href="#cb18-8"></a>    data.mat[,(j<span class="op">+</span><span class="dv">1</span>)] =<span class="st"> </span><span class="kw">g_divide_fj</span>(x, j)</span>
<span id="cb18-9"><a href="#cb18-9"></a>  }</span>
<span id="cb18-10"><a href="#cb18-10"></a></span>
<span id="cb18-11"><a href="#cb18-11"></a>  result.vec[i] =<span class="st"> </span><span class="kw">sum</span>(<span class="kw">colMeans</span>(data.mat))</span>
<span id="cb18-12"><a href="#cb18-12"></a>}</span>
<span id="cb18-13"><a href="#cb18-13"></a></span>
<span id="cb18-14"><a href="#cb18-14"></a>res &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="dt">est=</span><span class="kw">round</span>(<span class="kw">c</span>(<span class="fl">0.5257801</span>, result),<span class="dv">3</span>), <span class="dt">sd =</span> <span class="kw">round</span>(<span class="kw">c</span>(<span class="fl">0.0970314</span>, <span class="kw">sd</span>(result.vec)),<span class="dv">4</span>))</span>
<span id="cb18-15"><a href="#cb18-15"></a>  <span class="kw">colnames</span>(res) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Best Importance Sampling in Example 5.10&quot;</span>, <span class="st">&quot;Stratified Importance Sampleing&quot;</span>)</span>
<span id="cb18-16"><a href="#cb18-16"></a>  knitr<span class="op">::</span><span class="kw">kable</span>(res,<span class="dt">align=</span><span class="st">&#39;c&#39;</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Best Importance Sampling in Example 5.10</th>
<th align="center">Stratified Importance Sampleing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">est</td>
<td align="center">0.526</td>
<td align="center">0.5250</td>
</tr>
<tr class="even">
<td align="left">sd</td>
<td align="center">0.097</td>
<td align="center">0.0002</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="section-9" class="section level2">
<h2>6.4</h2>
<p><strong>Suppose that <span class="math inline">\(X_{1}, \ldots, X_{n}\)</span> are a random sample from a from a lognormal distribution with unknown parameters. Construct a <span class="math inline">\(95 \%\)</span> confidence interval for the parameter <span class="math inline">\(\mu .\)</span> Use a Monte Carlo method to obtain an empirical estimate of the confidence level. </strong></p>
<div id="solution.-6" class="section level3">
<h3>Solution.</h3>
<p><span class="math display">\[
X_i = e^{\mu+\sigma Z_i}, Z_i\stackrel{i.i.d.}{\sim}N(0,1).
\]</span> By t-test, we know that</p>
<p><span class="math display">\[
\frac{\sqrt{n}\left(\overline{\log(X)}-\mu\right)}{\sqrt{\frac{1}{n-1}\sum\left(\log(X_i)-\overline{\log(X)}\right)^2}}\sim t_{n-1}
\]</span></p>
</div>
</div>
</div>
<div id="hw-4-monte-carlo-methods-in-inference" class="section level1">
<h1>HW 4: Monte Carlo methods in inference</h1>
<div id="section-10" class="section level2">
<h2>6.7</h2>
<p>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(\operatorname{Beta}(\alpha, \alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</p>
<div id="solution.-7" class="section level3">
<h3>Solution.</h3>
<div id="against-symmetric-betaalpha-alpha" class="section level4">
<h4>1). Against symmetric <span class="math inline">\(Beta(\alpha, \alpha)\)</span></h4>
<p>Consider the random variable <span class="math inline">\(X\sim F\)</span>, also we define the skewness as</p>
<p><span class="math display">\[
\sqrt{\beta_{1}}=\frac{E\left[\left(X-\mu_{X}\right)\right]^{3}}{\sigma_{X}^{3}} 
\]</span></p>
<p>In this problem, we have hypothesis testing as</p>
<p><span class="math display">\[
H_0: X\sim F_{Norm} \longleftrightarrow H_1: X\sim \operatorname{Beta}(\alpha, \alpha) 
\]</span> The details of this hypothesis testing are shown in Example 6.8, hence we omit the repeated description.</p>
<p><em>[Flowchart: Monte Carlo experiment to estimate power of a test against a fixed alternative]</em></p>
<ol style="list-style-type: decimal">
<li><p>Select a particular value of the parameter <span class="math inline">\(\theta_{1} \in \Theta\)</span>.</p></li>
<li><p>For each replicate, indexed by <span class="math inline">\(j=1, \ldots, m\)</span> :</p></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Generate the <span class="math inline">\(j^{t h}\)</span> random sample <span class="math inline">\(x_{1}^{(j)}, \ldots, x_{n}^{(j)}\)</span> under the conditions of the alternative <span class="math inline">\(\theta=\theta_{1}\)</span>.</li>
<li>Compute the test statistic <span class="math inline">\(T_{j}\)</span> from the <span class="math inline">\(j^{t h}\)</span> sample.</li>
<li>Record the test decision: set <span class="math inline">\(I_{j}=1\)</span> if <span class="math inline">\(H_{0}\)</span> is rejected at significance level <span class="math inline">\(\alpha,\)</span> and otherwise set <span class="math inline">\(I_{j}=0\)</span></li>
</ol>
<ol start="3" style="list-style-type: decimal">
<li>Compute the proportion of significant tests <span class="math inline">\(\hat{\pi}\left(\theta_{1}\right)=\frac{1}{m} \sum_{j=1}^{m} I_{j}\)</span></li>
</ol>
<p>Now we move to the simulation stage.</p>
<p><strong>Experiment: Against symmetric <span class="math inline">\(Beta(\alpha, \alpha)\)</span>, different sample sizes, fixed <span class="math inline">\(\alpha = 1\)</span> in Beta distribution</strong></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>skew.ness =<span class="st"> </span><span class="cf">function</span>(x) {</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb19-3"><a href="#cb19-3"></a>m3 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">3</span>)</span>
<span id="cb19-4"><a href="#cb19-4"></a>m2 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x))<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</span>
<span id="cb19-6"><a href="#cb19-6"></a>}</span>
<span id="cb19-7"><a href="#cb19-7"></a></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="co">#different sample sizes</span></span>
<span id="cb19-9"><a href="#cb19-9"></a>n =<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>) </span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="co">#critical values for each n </span></span>
<span id="cb19-11"><a href="#cb19-11"></a>cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n)) </span>
<span id="cb19-12"><a href="#cb19-12"></a></span>
<span id="cb19-13"><a href="#cb19-13"></a></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="co">#n is a vector of sample sizes</span></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="co">#we are doing length(n) different simulations</span></span>
<span id="cb19-16"><a href="#cb19-16"></a>ht.power =<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n)) </span>
<span id="cb19-17"><a href="#cb19-17"></a>m =<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb19-19"><a href="#cb19-19"></a>    sktests =<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#test decisions </span></span>
<span id="cb19-20"><a href="#cb19-20"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb19-21"><a href="#cb19-21"></a>        x =<span class="st"> </span><span class="kw">rbeta</span>(n[i],<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb19-22"><a href="#cb19-22"></a>        <span class="co">#test decision is 1 (reject) or 0</span></span>
<span id="cb19-23"><a href="#cb19-23"></a>        sktests[j] =<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">skew.ness</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv[i] )</span>
<span id="cb19-24"><a href="#cb19-24"></a>    }</span>
<span id="cb19-25"><a href="#cb19-25"></a>    ht.power[i] =<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion rejected</span></span>
<span id="cb19-26"><a href="#cb19-26"></a>}</span>
<span id="cb19-27"><a href="#cb19-27"></a></span>
<span id="cb19-28"><a href="#cb19-28"></a></span>
<span id="cb19-29"><a href="#cb19-29"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="kw">t</span>(ht.power), <span class="dt">row.names =</span> <span class="st">&quot;Power&quot;</span>), <span class="dt">col.names =</span> <span class="kw">paste</span>(<span class="st">&quot;n =&quot;</span>, n))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">n = 10</th>
<th align="right">n = 20</th>
<th align="right">n = 30</th>
<th align="right">n = 50</th>
<th align="right">n = 100</th>
<th align="right">n = 500</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Power</td>
<td align="right">0.003</td>
<td align="right">0</td>
<td align="right">0.001</td>
<td align="right">0.001</td>
<td align="right">0.002</td>
<td align="right">0.002</td>
</tr>
</tbody>
</table>
<p><strong>Experiment: Against symmetric <span class="math inline">\(Beta(\alpha, \alpha)\)</span>, fixed sample sizes, different <span class="math inline">\(\alpha\)</span> in Beta distribution</strong></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co">#fixed sample size</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>n =<span class="st"> </span><span class="dv">100</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co">#different parameter alpha</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>alpha =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>) </span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co">#critical values for each n </span></span>
<span id="cb20-6"><a href="#cb20-6"></a>cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n)) </span>
<span id="cb20-7"><a href="#cb20-7"></a></span>
<span id="cb20-8"><a href="#cb20-8"></a></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="co">#n is a vector of sample sizes</span></span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="co">#we are doing length(n) different simulations</span></span>
<span id="cb20-11"><a href="#cb20-11"></a>ht.power =<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n)) </span>
<span id="cb20-12"><a href="#cb20-12"></a>m =<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(alpha)) {</span>
<span id="cb20-14"><a href="#cb20-14"></a>    sktests =<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#test decisions </span></span>
<span id="cb20-15"><a href="#cb20-15"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb20-16"><a href="#cb20-16"></a>        x =<span class="st"> </span><span class="kw">rbeta</span>(n,alpha[i], alpha[i])</span>
<span id="cb20-17"><a href="#cb20-17"></a>        <span class="co">#test decision is 1 (reject) or 0</span></span>
<span id="cb20-18"><a href="#cb20-18"></a>        sktests[j] =<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">skew.ness</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv )</span>
<span id="cb20-19"><a href="#cb20-19"></a>    }</span>
<span id="cb20-20"><a href="#cb20-20"></a>    ht.power[i] =<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion rejected</span></span>
<span id="cb20-21"><a href="#cb20-21"></a>}</span>
<span id="cb20-22"><a href="#cb20-22"></a></span>
<span id="cb20-23"><a href="#cb20-23"></a></span>
<span id="cb20-24"><a href="#cb20-24"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="kw">t</span>(ht.power), <span class="dt">row.names =</span> <span class="st">&quot;Power&quot;</span>), <span class="dt">col.names =</span> <span class="kw">paste</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">alpha$ =&quot;</span>, alpha))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right"><span class="math inline">\(\alpha\)</span> = 1</th>
<th align="right"><span class="math inline">\(\alpha\)</span> = 2</th>
<th align="right"><span class="math inline">\(\alpha\)</span> = 5</th>
<th align="right"><span class="math inline">\(\alpha\)</span> = 10</th>
<th align="right"><span class="math inline">\(\alpha\)</span> = 50</th>
<th align="right"><span class="math inline">\(\alpha\)</span> = 100</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Power</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0.003</td>
<td align="right">0.017</td>
<td align="right">0.036</td>
<td align="right">0.034</td>
</tr>
</tbody>
</table>
<p>We can see that as <span class="math inline">\(\alpha\)</span> grows large, the power tends to be close to 0.05.</p>
</div>
<div id="against-tnu" class="section level4">
<h4>2). Against <span class="math inline">\(t(\nu)\)</span></h4>
<p><strong>Experiment: Against symmetric <span class="math inline">\(t(\nu)\)</span>, different sample sizes, fixed <span class="math inline">\(\nu\)</span> in t distribution</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co">#n is a vector of sample sizes</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>n =<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>)</span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="co">#critical values for each n </span></span>
<span id="cb21-4"><a href="#cb21-4"></a>cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n)) </span>
<span id="cb21-5"><a href="#cb21-5"></a></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="co">#we are doing length(n) different simulations</span></span>
<span id="cb21-7"><a href="#cb21-7"></a>ht.power =<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n)) </span>
<span id="cb21-8"><a href="#cb21-8"></a>m =<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb21-9"><a href="#cb21-9"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb21-10"><a href="#cb21-10"></a>    sktests =<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#test decisions</span></span>
<span id="cb21-11"><a href="#cb21-11"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb21-12"><a href="#cb21-12"></a>        x =<span class="st"> </span><span class="kw">rt</span>(n[i],<span class="dv">1</span>)</span>
<span id="cb21-13"><a href="#cb21-13"></a>        <span class="co">#test decision is 1 (reject) or 0</span></span>
<span id="cb21-14"><a href="#cb21-14"></a>        sktests[j] =<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">skew.ness</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv[i] )</span>
<span id="cb21-15"><a href="#cb21-15"></a>    }</span>
<span id="cb21-16"><a href="#cb21-16"></a>    ht.power[i] =<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion rejected</span></span>
<span id="cb21-17"><a href="#cb21-17"></a>}</span>
<span id="cb21-18"><a href="#cb21-18"></a></span>
<span id="cb21-19"><a href="#cb21-19"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="kw">t</span>(ht.power), <span class="dt">row.names =</span> <span class="st">&quot;Power&quot;</span>), <span class="dt">col.names =</span> <span class="kw">paste</span>(<span class="st">&quot;n =&quot;</span>, n))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">n = 10</th>
<th align="right">n = 20</th>
<th align="right">n = 30</th>
<th align="right">n = 50</th>
<th align="right">n = 100</th>
<th align="right">n = 500</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Power</td>
<td align="right">0.457</td>
<td align="right">0.736</td>
<td align="right">0.836</td>
<td align="right">0.923</td>
<td align="right">0.965</td>
<td align="right">0.99</td>
</tr>
</tbody>
</table>
<p><strong>Experiment: Against symmetric <span class="math inline">\(t(\nu)\)</span>, fixed sample sizes, with different <span class="math inline">\(\nu\)</span> in t distribution</strong></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co">#fixed sample size</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>n =<span class="st"> </span><span class="dv">100</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co">#different parameter nu</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>nu =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">100</span>) </span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">#critical values for each n </span></span>
<span id="cb22-6"><a href="#cb22-6"></a>cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="fl">0.975</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n)) </span>
<span id="cb22-7"><a href="#cb22-7"></a></span>
<span id="cb22-8"><a href="#cb22-8"></a></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="co">#n is a vector of sample sizes</span></span>
<span id="cb22-10"><a href="#cb22-10"></a><span class="co">#we are doing length(n) different simulations</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>ht.power =<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n)) </span>
<span id="cb22-12"><a href="#cb22-12"></a>m =<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb22-13"><a href="#cb22-13"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(nu)) {</span>
<span id="cb22-14"><a href="#cb22-14"></a>    sktests =<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#test decisions </span></span>
<span id="cb22-15"><a href="#cb22-15"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</span>
<span id="cb22-16"><a href="#cb22-16"></a>        x =<span class="st"> </span><span class="kw">rt</span>(n,nu[i])</span>
<span id="cb22-17"><a href="#cb22-17"></a>        <span class="co">#test decision is 1 (reject) or 0</span></span>
<span id="cb22-18"><a href="#cb22-18"></a>        sktests[j] =<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">skew.ness</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv )</span>
<span id="cb22-19"><a href="#cb22-19"></a>    }</span>
<span id="cb22-20"><a href="#cb22-20"></a>    ht.power[i] =<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion rejected</span></span>
<span id="cb22-21"><a href="#cb22-21"></a>}</span>
<span id="cb22-22"><a href="#cb22-22"></a></span>
<span id="cb22-23"><a href="#cb22-23"></a></span>
<span id="cb22-24"><a href="#cb22-24"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="kw">t</span>(ht.power), <span class="dt">row.names =</span> <span class="st">&quot;Power&quot;</span>), <span class="dt">col.names =</span> <span class="kw">paste</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">nu$ =&quot;</span>, nu))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right"><span class="math inline">\(\nu\)</span> = 1</th>
<th align="right"><span class="math inline">\(\nu\)</span> = 2</th>
<th align="right"><span class="math inline">\(\nu\)</span> = 5</th>
<th align="right"><span class="math inline">\(\nu\)</span> = 10</th>
<th align="right"><span class="math inline">\(\nu\)</span> = 50</th>
<th align="right"><span class="math inline">\(\nu\)</span> = 100</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Power</td>
<td align="right">0.951</td>
<td align="right">0.816</td>
<td align="right">0.362</td>
<td align="right">0.192</td>
<td align="right">0.05</td>
<td align="right">0.049</td>
</tr>
</tbody>
</table>
<p>We can see that as <span class="math inline">\(\nu\)</span> grows large, the power tends to be close to 0.05.</p>
</div>
</div>
</div>
<div id="section-11" class="section level2">
<h2>6.8</h2>
<p>Refer to Example 6.16. Repeat the simulation, but also compute the <span class="math inline">\(F\)</span> test of equal variance, at significance level <span class="math inline">\(\hat{\alpha} \doteq 0.055 .\)</span> Compare the power of the Count Five test and <span class="math inline">\(F\)</span> test for small, medium, and large sample sizes. (Recall that the <span class="math inline">\(F\)</span> test is not applicable for non-normal distributions.)</p>
<div id="solution.-8" class="section level3">
<h3>Solution.</h3>
<div id="count-five-test-and-f-test-with-alphaapprox-0.055" class="section level4">
<h4>1). Count Five Test and F test with <span class="math inline">\(\alpha\approx 0.055\)</span></h4>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co">#count five test for one pair of samples</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb23-3"><a href="#cb23-3"></a>X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb23-4"><a href="#cb23-4"></a>Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb23-5"><a href="#cb23-5"></a>outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb23-6"><a href="#cb23-6"></a>outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">5</span>))</span>
<span id="cb23-9"><a href="#cb23-9"></a>}</span>
<span id="cb23-10"><a href="#cb23-10"></a></span>
<span id="cb23-11"><a href="#cb23-11"></a>alpha =<span class="st"> </span><span class="fl">0.055</span></span>
<span id="cb23-12"><a href="#cb23-12"></a>Ftest =<span class="st"> </span><span class="cf">function</span>(x, y, alpha){</span>
<span id="cb23-13"><a href="#cb23-13"></a>  <span class="co">#two sides F test</span></span>
<span id="cb23-14"><a href="#cb23-14"></a>  F.sta =<span class="st"> </span><span class="kw">var</span>(x)<span class="op">/</span><span class="kw">var</span>(y)</span>
<span id="cb23-15"><a href="#cb23-15"></a>  df1 =<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb23-16"><a href="#cb23-16"></a>  df2 =<span class="st"> </span><span class="kw">length</span>(y)</span>
<span id="cb23-17"><a href="#cb23-17"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>((F.sta<span class="op">&gt;</span><span class="kw">qf</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, df1, df2))<span class="op">|</span>(F.sta<span class="op">&lt;</span><span class="kw">qf</span>(alpha<span class="op">/</span><span class="dv">2</span>, df1, df2))))</span>
<span id="cb23-18"><a href="#cb23-18"></a>}</span>
<span id="cb23-19"><a href="#cb23-19"></a></span>
<span id="cb23-20"><a href="#cb23-20"></a><span class="co">#sample sizes</span></span>
<span id="cb23-21"><a href="#cb23-21"></a>n =<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">30</span>, <span class="dv">100</span>)</span>
<span id="cb23-22"><a href="#cb23-22"></a><span class="co">#repeated times</span></span>
<span id="cb23-23"><a href="#cb23-23"></a>m =<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb23-24"><a href="#cb23-24"></a></span>
<span id="cb23-25"><a href="#cb23-25"></a><span class="co">#calculate the power</span></span>
<span id="cb23-26"><a href="#cb23-26"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb23-27"><a href="#cb23-27"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb23-28"><a href="#cb23-28"></a></span>
<span id="cb23-29"><a href="#cb23-29"></a>power =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="kw">length</span>(n))</span>
<span id="cb23-30"><a href="#cb23-30"></a></span>
<span id="cb23-31"><a href="#cb23-31"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb23-32"><a href="#cb23-32"></a>  power[,i] =<span class="st"> </span><span class="kw">apply</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb23-33"><a href="#cb23-33"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma1)</span>
<span id="cb23-34"><a href="#cb23-34"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n[i], <span class="dv">0</span>, sigma2)</span>
<span id="cb23-35"><a href="#cb23-35"></a><span class="kw">c</span>(<span class="kw">count5test</span>(x, y), <span class="kw">Ftest</span>(x, y, alpha))</span>
<span id="cb23-36"><a href="#cb23-36"></a>}), <span class="dt">MARGIN =</span> <span class="dv">1</span>, mean)</span>
<span id="cb23-37"><a href="#cb23-37"></a>}</span></code></pre></div>
</div>
<div id="comparison" class="section level4">
<h4>2). Comparison</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(power, <span class="dt">row.names =</span> <span class="kw">c</span>(<span class="st">&quot;Count Five Test&quot;</span>, <span class="st">&quot;F test with condifence level 0.055&quot;</span>)), <span class="dt">col.names =</span> <span class="kw">paste</span>(<span class="st">&quot;n =&quot;</span>, n))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">n = 5</th>
<th align="right">n = 30</th>
<th align="right">n = 100</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Count Five Test</td>
<td align="right">0.00</td>
<td align="right">0.478</td>
<td align="right">0.851</td>
</tr>
<tr class="even">
<td align="left">F test with condifence level 0.055</td>
<td align="right">0.16</td>
<td align="right">0.598</td>
<td align="right">0.978</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="c" class="section level2">
<h2>6.C</h2>
<p>Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1, d}\)</span> is defined by Mardia as <span class="math display">\[
\beta_{1, d}=E\left[(X-\mu)^{T} \Sigma^{-1}(Y-\mu)\right]^{3}
\]</span> Under normality, <span class="math inline">\(\beta_{1, d}=0 .\)</span> The multivariate skewness statistic is <span class="math display">\[
b_{1, d}=\frac{1}{n^{2}} \sum_{i, j=1}^{n}\left(\left(X_{i}-\bar{X}\right)^{T} \widehat{\Sigma}^{-1}\left(X_{j}-\bar{X}\right)\right)^{3}
\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1, d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(n b_{1, d} / 6\)</span> is chisquared with <span class="math inline">\(d(d+1)(d+2) / 6\)</span> degrees of freedom.</p>
<div id="solution.-9" class="section level3">
<h3>Solution.</h3>
<div id="repeat-example-6.8-for-mardias-multivariate-skewness-test" class="section level4">
<h4>1). Repeat Example 6.8 for Mardia’s multivariate skewness test</h4>
<p>Since the notations are described by the problem, we move to the simulation stage.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>mul.sk =<span class="st"> </span><span class="cf">function</span>(X){</span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="co">#X is a n*d matrix containing one group of samples</span></span>
<span id="cb25-3"><a href="#cb25-3"></a>  n =<span class="st"> </span><span class="kw">nrow</span>(X)</span>
<span id="cb25-4"><a href="#cb25-4"></a>  d =<span class="st"> </span><span class="kw">ncol</span>(X)</span>
<span id="cb25-5"><a href="#cb25-5"></a>  barX =<span class="st"> </span><span class="kw">apply</span>(X, <span class="dv">2</span>, mean)</span>
<span id="cb25-6"><a href="#cb25-6"></a>  Sigma.inverse =<span class="st"> </span><span class="kw">solve</span>(<span class="kw">var</span>(X))</span>
<span id="cb25-7"><a href="#cb25-7"></a>  </span>
<span id="cb25-8"><a href="#cb25-8"></a>  stat =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb25-9"><a href="#cb25-9"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb25-10"><a href="#cb25-10"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb25-11"><a href="#cb25-11"></a>      stat =<span class="st"> </span>stat <span class="op">+</span><span class="st"> </span>(<span class="kw">t</span>(X[i,]<span class="op">-</span>barX) <span class="op">%*%</span><span class="st"> </span>Sigma.inverse <span class="op">%*%</span><span class="st"> </span>(X[j,]<span class="op">-</span>barX))<span class="op">^</span><span class="dv">3</span></span>
<span id="cb25-12"><a href="#cb25-12"></a>    }</span>
<span id="cb25-13"><a href="#cb25-13"></a>  }</span>
<span id="cb25-14"><a href="#cb25-14"></a>  </span>
<span id="cb25-15"><a href="#cb25-15"></a>  stat<span class="op">/</span>(n<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb25-16"><a href="#cb25-16"></a>}</span>
<span id="cb25-17"><a href="#cb25-17"></a></span>
<span id="cb25-18"><a href="#cb25-18"></a><span class="co">#different sample sizes</span></span>
<span id="cb25-19"><a href="#cb25-19"></a>n =<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">100</span>)</span>
<span id="cb25-20"><a href="#cb25-20"></a></span>
<span id="cb25-21"><a href="#cb25-21"></a><span class="co">#dimension d</span></span>
<span id="cb25-22"><a href="#cb25-22"></a>d =<span class="st"> </span><span class="dv">2</span></span>
<span id="cb25-23"><a href="#cb25-23"></a><span class="co">#repeated times</span></span>
<span id="cb25-24"><a href="#cb25-24"></a>m =<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb25-25"><a href="#cb25-25"></a></span>
<span id="cb25-26"><a href="#cb25-26"></a><span class="co">#critical values for each n </span></span>
<span id="cb25-27"><a href="#cb25-27"></a>cv =<span class="st"> </span><span class="dv">6</span><span class="op">*</span><span class="kw">qchisq</span>(<span class="fl">0.95</span>, <span class="dt">df =</span> d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)<span class="op">/</span>n </span>
<span id="cb25-28"><a href="#cb25-28"></a></span>
<span id="cb25-29"><a href="#cb25-29"></a></span>
<span id="cb25-30"><a href="#cb25-30"></a>p.rej =<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(n))</span>
<span id="cb25-31"><a href="#cb25-31"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</span>
<span id="cb25-32"><a href="#cb25-32"></a>  p.rej[i] =<span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb25-33"><a href="#cb25-33"></a>  X =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(d<span class="op">*</span>n[i]), <span class="dt">ncol =</span> d)</span>
<span id="cb25-34"><a href="#cb25-34"></a>  <span class="kw">as.integer</span>(<span class="kw">mul.sk</span>(X)<span class="op">&gt;</span>cv[i])</span>
<span id="cb25-35"><a href="#cb25-35"></a>}))</span>
<span id="cb25-36"><a href="#cb25-36"></a>}</span>
<span id="cb25-37"><a href="#cb25-37"></a></span>
<span id="cb25-38"><a href="#cb25-38"></a></span>
<span id="cb25-39"><a href="#cb25-39"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="kw">t</span>(p.rej), <span class="dt">row.names =</span> <span class="st">&quot;Type one Error&quot;</span>), <span class="dt">col.names =</span> <span class="kw">paste</span>(<span class="st">&quot;n =&quot;</span>, n))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">n = 10</th>
<th align="right">n = 20</th>
<th align="right">n = 30</th>
<th align="right">n = 50</th>
<th align="right">n = 100</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Type one Error</td>
<td align="right">0</td>
<td align="right">0.016</td>
<td align="right">0.025</td>
<td align="right">0.032</td>
<td align="right">0.059</td>
</tr>
</tbody>
</table>
</div>
<div id="repeat-example-6.10-for-mardias-multivariate-skewness-test" class="section level4">
<h4>2). Repeat Example 6.10 for Mardia’s multivariate skewness test</h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co">#different sample sizes</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>n =<span class="st"> </span><span class="dv">30</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co">#dimension d</span></span>
<span id="cb26-4"><a href="#cb26-4"></a>d =<span class="st"> </span><span class="dv">2</span></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co">#repeated times</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>m =<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co">#confidence level</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>alpha =<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb26-9"><a href="#cb26-9"></a></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="co">#critical values for each n </span></span>
<span id="cb26-11"><a href="#cb26-11"></a>cv =<span class="st"> </span><span class="dv">6</span><span class="op">*</span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha, <span class="dt">df =</span> d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)<span class="op">/</span>n </span>
<span id="cb26-12"><a href="#cb26-12"></a></span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="co">#epsilon</span></span>
<span id="cb26-14"><a href="#cb26-14"></a>epsilon =<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">0.14</span>, <span class="fl">0.01</span>), <span class="kw">seq</span>(<span class="fl">0.15</span>, <span class="dv">1</span>, <span class="fl">0.05</span>))</span>
<span id="cb26-15"><a href="#cb26-15"></a></span>
<span id="cb26-16"><a href="#cb26-16"></a>pwr =<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(epsilon))</span>
<span id="cb26-17"><a href="#cb26-17"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(epsilon)) {</span>
<span id="cb26-18"><a href="#cb26-18"></a>  e =<span class="st"> </span>epsilon[i]</span>
<span id="cb26-19"><a href="#cb26-19"></a>  pwr[i] =<span class="kw">mean</span>(<span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb26-20"><a href="#cb26-20"></a>  sigma =<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,</span>
<span id="cb26-21"><a href="#cb26-21"></a><span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb26-22"><a href="#cb26-22"></a></span>
<span id="cb26-23"><a href="#cb26-23"></a>  X =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(d<span class="op">*</span>n, <span class="dt">sd =</span> sigma), <span class="dt">ncol =</span> d)</span>
<span id="cb26-24"><a href="#cb26-24"></a>  <span class="kw">as.integer</span>(<span class="kw">mul.sk</span>(X)<span class="op">&gt;</span>cv)</span>
<span id="cb26-25"><a href="#cb26-25"></a>}))</span>
<span id="cb26-26"><a href="#cb26-26"></a>}</span>
<span id="cb26-27"><a href="#cb26-27"></a></span>
<span id="cb26-28"><a href="#cb26-28"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="kw">t</span>(pwr), <span class="dt">row.names =</span> <span class="st">&quot;Power&quot;</span>), <span class="dt">col.names =</span> <span class="kw">paste</span>(<span class="st">&quot;$</span><span class="ch">\\</span><span class="st">epsilon$ =&quot;</span>, epsilon))</span></code></pre></div>
<table>
<colgroup>
<col width="1%"></col>
<col width="2%"></col>
<col width="3%"></col>
<col width="3%"></col>
<col width="3%"></col>
<col width="3%"></col>
<col width="3%"></col>
<col width="3%"></col>
<col width="3%"></col>
<col width="3%"></col>
<col width="3%"></col>
<col width="2%"></col>
<col width="3%"></col>
<col width="3%"></col>
<col width="3%"></col>
<col width="3%"></col>
<col width="3%"></col>
<col width="2%"></col>
<col width="3%"></col>
<col width="2%"></col>
<col width="3%"></col>
<col width="2%"></col>
<col width="3%"></col>
<col width="2%"></col>
<col width="3%"></col>
<col width="2%"></col>
<col width="3%"></col>
<col width="2%"></col>
<col width="3%"></col>
<col width="2%"></col>
<col width="3%"></col>
<col width="2%"></col>
<col width="3%"></col>
<col width="2%"></col>
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.01</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.02</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.03</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.04</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.05</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.06</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.07</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.08</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.09</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.1</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.11</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.12</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.13</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.14</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.15</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.2</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.25</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.3</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.35</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.4</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.45</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.5</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.55</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.6</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.65</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.7</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.75</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.8</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.85</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.9</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 0.95</th>
<th align="right"><span class="math inline">\(\epsilon\)</span> = 1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Power</td>
<td align="right">0.051</td>
<td align="right">0.266</td>
<td align="right">0.43</td>
<td align="right">0.573</td>
<td align="right">0.709</td>
<td align="right">0.757</td>
<td align="right">0.797</td>
<td align="right">0.883</td>
<td align="right">0.914</td>
<td align="right">0.919</td>
<td align="right">0.928</td>
<td align="right">0.952</td>
<td align="right">0.969</td>
<td align="right">0.97</td>
<td align="right">0.961</td>
<td align="right">0.981</td>
<td align="right">0.984</td>
<td align="right">0.95</td>
<td align="right">0.919</td>
<td align="right">0.869</td>
<td align="right">0.803</td>
<td align="right">0.725</td>
<td align="right">0.639</td>
<td align="right">0.563</td>
<td align="right">0.483</td>
<td align="right">0.395</td>
<td align="right">0.304</td>
<td align="right">0.246</td>
<td align="right">0.178</td>
<td align="right">0.118</td>
<td align="right">0.093</td>
<td align="right">0.063</td>
<td align="right">0.061</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="co">#plot power vs epsilon</span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb27-6"><a href="#cb27-6"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors</span></span>
<span id="cb27-7"><a href="#cb27-7"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="kw">lines</span>(epsilon, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="discussion." class="section level2">
<h2>Discussion.</h2>
<p><strong>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level? </strong></p>
<ol style="list-style-type: decimal">
<li><p>What is the corresponding hypothesis test problem?</p></li>
<li><p>What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p></li>
<li><p>What information is needed to test your hypothesis?</p></li>
</ol>
<div id="solution.-10" class="section level3">
<h3>Solution.</h3>
<div id="section-12" class="section level4">
<h4>1).</h4>
<p>For the first method corresponding to a hypothesis testing, define the random variable of interest as <span class="math display">\[
X = \mathbb{I}(\text{Reject } H_0^{old} \text{ with first method })
\]</span></p>
<p>it is easy to see</p>
<p><span class="math display">\[
\mu_1\equiv\mathbb{E}_{H_1^{old}} X = \mathbb{P}_{H_1^{old}}(\text{Reject }H_0^{old} \text{ with first method}) = \text{Power}_1
\]</span></p>
<p>Similarly we can define <span class="math inline">\(Y\)</span> and <span class="math inline">\(\mu_2 = \text{Power}_2\)</span> corresponding to the second method.</p>
<p>Now we are interested of the mean shifted problem</p>
<p><span class="math display">\[
H_0: \mu_1 = \mu_2 \longleftrightarrow H_1:\mu_1\neq \mu_2
\]</span></p>
</div>
<div id="section-13" class="section level4">
<h4>2).</h4>
<p>If we apply <span class="math inline">\(n\)</span> times Monte Carlo experiments respectively under each method, we will get <span class="math inline">\(x_1, x_2, \ldots, x_n\)</span> and <span class="math inline">\(y_1, y_2, \ldots, y_n\)</span>.</p>
<p>Naturally we define</p>
<p><span class="math display">\[
z_i = y_i-x_i \in\{-1,0,1\}
\]</span> The problem is transformed to test</p>
<p><span class="math display">\[
H_0: \mu_z = 0 \longleftrightarrow H_1:\mu_z\neq 0
\]</span></p>
<p><strong>Z-test</strong>: If we assume the <span class="math inline">\(Z_i\)</span> are i.i.d, then Z-test can be applied if <span class="math inline">\(n\)</span> is large.</p>
<p><strong>Two sample t-test</strong>: Two sample t-test requires the independence between the groups of data, which is hard to satisfy since <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are the power for the same hypothesis testing, though under different method.</p>
<p><strong>Paired t-test</strong>: If we assume <span class="math inline">\(Z_i\)</span> are i.i.d. normal, then we can definitely apply paired t-test. If we only assume <span class="math inline">\(Z_i\)</span> i.i.d but <span class="math inline">\(n\)</span> is large, the paired t-test still works.</p>
<p><strong>McNemar Test</strong>: Obviously applicable.</p>
</div>
<div id="section-14" class="section level4">
<h4>3).</h4>
<p>Commonly we only need the assumption that <span class="math inline">\(z_i\)</span> are i.i.d, and the observations of all <span class="math inline">\(z_i\)</span>.</p>
</div>
</div>
</div>
</div>
<div id="hw-5-boostrap-jackknife-permutation" class="section level1">
<h1>HW 5: Boostrap Jackknife Permutation</h1>
<div id="section-15" class="section level2">
<h2>7.1</h2>
<p>Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
<div id="solution.-11" class="section level3">
<h3>Solution.</h3>
<p>Consider <span class="math inline">\(\hat{\theta}\)</span> representing a plug-in statistic, then we have the jackknife estimate of bias as, details are omitted here</p>
<p><span class="math display">\[
\widehat{\text {bias}}_{\text {jack}}=(n-1)\left(\overline{\hat{\theta}}_{(\cdot)}-\hat{\theta}\right)
\]</span></p>
<p>where <span class="math inline">\(\overline{\hat{\theta}}_{(\cdot)}=\frac{1}{n} \sum_{i=1}^{n} \hat{\theta}_{(i)}\)</span>.</p>
<p>So we apply the above formula,</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">library</span>(bootstrap)</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="co">#&gt; Warning: package &#39;bootstrap&#39; was built under R version 4.0.3</span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="co">#the statistic of interest</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>theta.hat =<span class="st"> </span><span class="kw">cor</span>(law<span class="op">$</span>LSAT, law<span class="op">$</span>GPA)</span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="co">#sample size</span></span>
<span id="cb28-6"><a href="#cb28-6"></a>n =<span class="st"> </span><span class="kw">nrow</span>(law)</span>
<span id="cb28-7"><a href="#cb28-7"></a></span>
<span id="cb28-8"><a href="#cb28-8"></a><span class="co">#compute the jackknife replicates, leave-one-out estimates</span></span>
<span id="cb28-9"><a href="#cb28-9"></a>theta.jack =<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb28-10"><a href="#cb28-10"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb28-11"><a href="#cb28-11"></a> theta.jack[i] =<span class="st"> </span><span class="kw">cor</span>(law<span class="op">$</span>LSAT[<span class="op">-</span>i], law<span class="op">$</span>GPA[<span class="op">-</span>i])</span>
<span id="cb28-12"><a href="#cb28-12"></a>}</span>
<span id="cb28-13"><a href="#cb28-13"></a></span>
<span id="cb28-14"><a href="#cb28-14"></a>bias.jack =<span class="st"> </span>(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span>theta.hat)</span>
<span id="cb28-15"><a href="#cb28-15"></a>bias.jack</span>
<span id="cb28-16"><a href="#cb28-16"></a><span class="co">#&gt; [1] -0.006473623</span></span></code></pre></div>
<p>Next, the jackknife estimate of the standard error of <span class="math inline">\(\hat{\theta}\)</span> is</p>
<p><span class="math display">\[
\widehat{s e}_{j a c k}=\sqrt{\frac{n-1}{n} \sum_{i=1}^{n}\left(\hat{\theta}_{(i)}-\bar{\theta}_{(\cdot)}\right)^{2}}
\]</span></p>
<p>The simulation is similar,</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co">#compute the jackknife estimate of se</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>se.jack =<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">sd</span>(theta.jack)<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>n)</span>
<span id="cb29-3"><a href="#cb29-3"></a>se.jack</span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="co">#&gt; [1] 0.1425186</span></span>
<span id="cb29-5"><a href="#cb29-5"></a></span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="co">#The results. </span></span>
<span id="cb29-7"><a href="#cb29-7"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(bias.jack, se.jack), <span class="dt">col.names =</span><span class="kw">c</span>(<span class="st">&quot;Jackknife Estimate of Bias&quot;</span>, <span class="st">&quot;Jackknife Estimate of SE&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Jackknife Estimate of Bias</th>
<th align="right">Jackknife Estimate of SE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.0064736</td>
<td align="right">0.1425186</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="section-16" class="section level2">
<h2>7.5</h2>
<p>Refer to Exercise 7.4. Compute <span class="math inline">\(95\%\)</span> bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1 / \lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
<div id="solution.-12" class="section level3">
<h3>Solution.</h3>
<p>We denote the likelihood with <span class="math inline">\(\mathcal{L}\)</span> and the log-likelihood with <span class="math inline">\(\mathcal{LL}\)</span>.</p>
<p>Firstly we simply derive the MLE for the hazard rate <span class="math inline">\(\lambda\)</span>,</p>
<p><span class="math display">\[
\begin{aligned}
\mathcal{L} &amp;= \prod_{i=1}^n f(X_i)\\
&amp;=\lambda^n\exp\left\{-\lambda\sum_{i=1}^n X_i\right\}\\
\implies\mathcal{LL} &amp;= n\log(\lambda)-\lambda\sum_{i=1}^nX_i\\
\implies \frac{\partial\mathcal{LL}}{\partial\lambda} &amp;= \frac{n}{\lambda}-\sum_{i=1}^nX_i = 0\\
\implies \hat{\lambda} &amp;= \bar{X}^{-1}
\end{aligned}
\]</span></p>
</div>
</div>
</div>
<div id="hw-6-markov-chain-montel-carlo-methods" class="section level1">
<h1>HW 6: Markov Chain Montel Carlo methods</h1>
<div id="section-17" class="section level2">
<h2>8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
<div id="solution.-13" class="section level3">
<h3>Solution.</h3>
<p>Since the count five test does not work efficiently under the case for unequal sample sizes, instead we apply the permutation test.</p>
<p>As is known, even the sample size is not large, the permutations can be a large amount. We choose a random sample from all the permutations.</p>
<p>Below is the flowchart,</p>
<p><em>[Permutation tests on equal variance]</em></p>
<ol style="list-style-type: decimal">
<li><p>Use a random sample of <span class="math inline">\(T_{1}^{*}, \ldots, T^\ast_{\left(\begin{matrix}N\\n\end{matrix}\right)}\)</span>.</p></li>
<li><p>Compute the observed test statistic <span class="math inline">\(T(X, Y)=\tilde{T}(Z, \nu)\)</span>, <span class="math inline">\(\nu=(1, \ldots, N)\)</span>.</p></li>
<li><p>For each replicate, indexed <span class="math inline">\(b=1, \ldots, B\)</span>:</p>
<ol style="list-style-type: decimal">
<li><p>Generate a random permutation <span class="math inline">\(\pi_{b}=\pi(\nu)\)</span> (sample <span class="math inline">\((1: N)\)</span>)</p></li>
<li><p>Compute the statistic <span class="math inline">\(T_{b}^{*}=\tilde{T}\left(Z, \pi_{b}\right)\)</span></p></li>
</ol></li>
<li><p>If a large value of <span class="math inline">\(T\)</span> favors <span class="math inline">\(H_{a}\)</span> (upper-tailed test), <span class="math display">\[
\hat{p}=\frac{1+\#\left\{T_{b}^{*} \geq T\right\}}{1+B}=\frac{1+\sum_{i=1}^{B} I\left(T_{b}^{*} \geq T\right)}{1+B}
\]</span> For lower-tailed test or two-tailed test, <span class="math inline">\(\hat{p}\)</span> is computed in a similar way.</p></li>
<li><p>Reject <span class="math inline">\(H_{0}\)</span> at significance level <span class="math inline">\(\alpha\)</span> if <span class="math inline">\(\hat{p} \leq \alpha\)</span></p></li>
</ol>
<p><span class="math inline">\(\quad\)</span></p>
<p><strong>Case1: <span class="math inline">\(n_1 = 20\)</span>, <span class="math inline">\(n_2 = 30\)</span></strong></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="co">#maximum of extreme points </span></span>
<span id="cb30-3"><a href="#cb30-3"></a>max.ext.pts =<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb30-4"><a href="#cb30-4"></a>X =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb30-5"><a href="#cb30-5"></a>Y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb30-6"><a href="#cb30-6"></a>outx =<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb30-7"><a href="#cb30-7"></a>outy =<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb30-8"><a href="#cb30-8"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb30-9"><a href="#cb30-9"></a><span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</span>
<span id="cb30-10"><a href="#cb30-10"></a>}</span>
<span id="cb30-11"><a href="#cb30-11"></a></span>
<span id="cb30-12"><a href="#cb30-12"></a><span class="co">#sample sizes</span></span>
<span id="cb30-13"><a href="#cb30-13"></a>n1 =<span class="st"> </span><span class="dv">20</span></span>
<span id="cb30-14"><a href="#cb30-14"></a>n2 =<span class="st"> </span><span class="dv">30</span></span>
<span id="cb30-15"><a href="#cb30-15"></a></span>
<span id="cb30-16"><a href="#cb30-16"></a><span class="co">#repeated times</span></span>
<span id="cb30-17"><a href="#cb30-17"></a>m =<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb30-18"><a href="#cb30-18"></a></span>
<span id="cb30-19"><a href="#cb30-19"></a><span class="co">#calculate the power</span></span>
<span id="cb30-20"><a href="#cb30-20"></a>sigma1 =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb30-21"><a href="#cb30-21"></a>sigma2 =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb30-22"><a href="#cb30-22"></a></span>
<span id="cb30-23"><a href="#cb30-23"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(n1, <span class="dv">0</span>, sigma1)</span>
<span id="cb30-24"><a href="#cb30-24"></a>y =<span class="st"> </span><span class="kw">rnorm</span>(n2, <span class="dv">0</span>, sigma2)</span>
<span id="cb30-25"><a href="#cb30-25"></a>z =<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb30-26"><a href="#cb30-26"></a>t0 =<span class="st"> </span><span class="kw">max.ext.pts</span>(x, y)</span>
<span id="cb30-27"><a href="#cb30-27"></a></span>
<span id="cb30-28"><a href="#cb30-28"></a>  hat.p =<span class="st"> </span>(<span class="kw">sum</span>(<span class="kw">replicate</span>((m<span class="dv">-1</span>), <span class="dt">expr=</span>{</span>
<span id="cb30-29"><a href="#cb30-29"></a>    idx =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>(n1<span class="op">+</span>n2), <span class="dt">size =</span> n1, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb30-30"><a href="#cb30-30"></a>    <span class="kw">as.integer</span>(<span class="kw">max.ext.pts</span>(z[idx], z[<span class="op">-</span>idx])<span class="op">&gt;=</span>t0)</span>
<span id="cb30-31"><a href="#cb30-31"></a>}))<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>m</span>
<span id="cb30-32"><a href="#cb30-32"></a></span>
<span id="cb30-33"><a href="#cb30-33"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The estimate of p value is &quot;</span>, <span class="kw">round</span>(hat.p, <span class="dv">4</span>), <span class="st">&quot;.&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb30-34"><a href="#cb30-34"></a><span class="co">#&gt; [1] &quot;The estimate of p value is 0.8559.&quot;</span></span></code></pre></div>
<p><strong>Case2: <span class="math inline">\(n_1 = 20\)</span>, <span class="math inline">\(n_2 = 50\)</span></strong></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="co">#maximum of extreme points </span></span>
<span id="cb31-3"><a href="#cb31-3"></a>max.ext.pts =<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb31-4"><a href="#cb31-4"></a>X =<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb31-5"><a href="#cb31-5"></a>Y =<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</span>
<span id="cb31-6"><a href="#cb31-6"></a>outx =<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb31-7"><a href="#cb31-7"></a>outy =<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb31-8"><a href="#cb31-8"></a><span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb31-9"><a href="#cb31-9"></a><span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</span>
<span id="cb31-10"><a href="#cb31-10"></a>}</span>
<span id="cb31-11"><a href="#cb31-11"></a></span>
<span id="cb31-12"><a href="#cb31-12"></a><span class="co">#sample sizes</span></span>
<span id="cb31-13"><a href="#cb31-13"></a>n1 =<span class="st"> </span><span class="dv">20</span></span>
<span id="cb31-14"><a href="#cb31-14"></a>n2 =<span class="st"> </span><span class="dv">50</span></span>
<span id="cb31-15"><a href="#cb31-15"></a></span>
<span id="cb31-16"><a href="#cb31-16"></a><span class="co">#repeated times</span></span>
<span id="cb31-17"><a href="#cb31-17"></a>m =<span class="st"> </span><span class="dv">10000</span></span>
<span id="cb31-18"><a href="#cb31-18"></a></span>
<span id="cb31-19"><a href="#cb31-19"></a><span class="co">#calculate the power</span></span>
<span id="cb31-20"><a href="#cb31-20"></a>sigma1 =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb31-21"><a href="#cb31-21"></a>sigma2 =<span class="st"> </span><span class="dv">1</span></span>
<span id="cb31-22"><a href="#cb31-22"></a></span>
<span id="cb31-23"><a href="#cb31-23"></a>x =<span class="st"> </span><span class="kw">rnorm</span>(n1, <span class="dv">0</span>, sigma1)</span>
<span id="cb31-24"><a href="#cb31-24"></a>y =<span class="st"> </span><span class="kw">rnorm</span>(n2, <span class="dv">0</span>, sigma2)</span>
<span id="cb31-25"><a href="#cb31-25"></a>z =<span class="st"> </span><span class="kw">c</span>(x, y)</span>
<span id="cb31-26"><a href="#cb31-26"></a>t0 =<span class="st"> </span><span class="kw">max.ext.pts</span>(x, y)</span>
<span id="cb31-27"><a href="#cb31-27"></a></span>
<span id="cb31-28"><a href="#cb31-28"></a>  hat.p =<span class="st"> </span>(<span class="kw">sum</span>(<span class="kw">replicate</span>((m<span class="dv">-1</span>), <span class="dt">expr=</span>{</span>
<span id="cb31-29"><a href="#cb31-29"></a>    idx =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>(n1<span class="op">+</span>n2), <span class="dt">size =</span> n1, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb31-30"><a href="#cb31-30"></a>    <span class="kw">as.integer</span>(<span class="kw">max.ext.pts</span>(z[idx], z[<span class="op">-</span>idx])<span class="op">&gt;=</span>t0)</span>
<span id="cb31-31"><a href="#cb31-31"></a>}))<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>m</span>
<span id="cb31-32"><a href="#cb31-32"></a></span>
<span id="cb31-33"><a href="#cb31-33"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;The estimate of p value is &quot;</span>, <span class="kw">round</span>(hat.p, <span class="dv">4</span>), <span class="st">&quot;.&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>))</span>
<span id="cb31-34"><a href="#cb31-34"></a><span class="co">#&gt; [1] &quot;The estimate of p value is 0.7048.&quot;</span></span></code></pre></div>
<p>So we strongly protect the Null hypothesis in both cases through permutation tests.</p>
</div>
</div>
<div id="design-experiments-for-evaluating-the-performance-of-the-nn-energy-and-ball-methods-in-various-situations." class="section level2">
<h2>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations.</h2>
<ul>
<li>Unequal variances and equal expectations</li>
<li>Unequal variances and unequal expectations</li>
<li>Non-normal distributions: <span class="math inline">\(\mathrm{t}\)</span> distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</li>
<li>Unbalanced samples (say, 1 case versus 10 controls)</li>
<li>Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8)</li>
</ul>
<div id="solution.-14" class="section level3">
<h3>Solution.</h3>
<p><strong>Case1: Unequal variances and equal expectations</strong></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">library</span>(RANN) </span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="co">#&gt; Warning: package &#39;RANN&#39; was built under R version 4.0.3</span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="kw">library</span>(boot)</span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="kw">library</span>(energy)</span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="co">#&gt; Warning: package &#39;energy&#39; was built under R version 4.0.3</span></span>
<span id="cb32-6"><a href="#cb32-6"></a><span class="kw">library</span>(Ball)</span>
<span id="cb32-7"><a href="#cb32-7"></a><span class="co">#&gt; Warning: package &#39;Ball&#39; was built under R version 4.0.3</span></span>
<span id="cb32-8"><a href="#cb32-8"></a></span>
<span id="cb32-9"><a href="#cb32-9"></a>Tn =<span class="st"> </span><span class="cf">function</span>(z, ix, sizes,k) {</span>
<span id="cb32-10"><a href="#cb32-10"></a>n1 =<span class="st"> </span>sizes[<span class="dv">1</span>]; n2 =<span class="st"> </span>sizes[<span class="dv">2</span>]; n =<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb32-11"><a href="#cb32-11"></a><span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z =<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>);</span>
<span id="cb32-12"><a href="#cb32-12"></a>z =<span class="st"> </span>z[ix, ];</span>
<span id="cb32-13"><a href="#cb32-13"></a>NN =<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb32-14"><a href="#cb32-14"></a>block1 =<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb32-15"><a href="#cb32-15"></a>block2 =<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb32-16"><a href="#cb32-16"></a>i1 =<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>); i2 =<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>)</span>
<span id="cb32-17"><a href="#cb32-17"></a>(i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb32-18"><a href="#cb32-18"></a>}</span>
<span id="cb32-19"><a href="#cb32-19"></a></span>
<span id="cb32-20"><a href="#cb32-20"></a></span>
<span id="cb32-21"><a href="#cb32-21"></a>m =<span class="st"> </span><span class="fl">1e2</span>; k=<span class="dv">3</span>; p=<span class="dv">2</span>;  </span>
<span id="cb32-22"><a href="#cb32-22"></a>n1 =<span class="st"> </span>n2 =<span class="st"> </span><span class="dv">50</span>; R=<span class="dv">999</span>; n =<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb32-23"><a href="#cb32-23"></a></span>
<span id="cb32-24"><a href="#cb32-24"></a>eqdist.nn =<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb32-25"><a href="#cb32-25"></a>boot.obj =<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,</span>
<span id="cb32-26"><a href="#cb32-26"></a><span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb32-27"><a href="#cb32-27"></a>ts =<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb32-28"><a href="#cb32-28"></a>p.value =<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb32-29"><a href="#cb32-29"></a><span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb32-30"><a href="#cb32-30"></a>}</span>
<span id="cb32-31"><a href="#cb32-31"></a></span>
<span id="cb32-32"><a href="#cb32-32"></a>p.values =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,m,<span class="dv">3</span>)</span>
<span id="cb32-33"><a href="#cb32-33"></a></span>
<span id="cb32-34"><a href="#cb32-34"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb32-35"><a href="#cb32-35"></a>x =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p, <span class="dv">0</span>, <span class="fl">1.5</span>), <span class="dt">ncol =</span> p)</span>
<span id="cb32-36"><a href="#cb32-36"></a>y =<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2))</span>
<span id="cb32-37"><a href="#cb32-37"></a>z =<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb32-38"><a href="#cb32-38"></a></span>
<span id="cb32-39"><a href="#cb32-39"></a></span>
<span id="cb32-40"><a href="#cb32-40"></a>p.values[i,<span class="dv">1</span>] =<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb32-41"><a href="#cb32-41"></a>p.values[i,<span class="dv">2</span>] =<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb32-42"><a href="#cb32-42"></a>p.values[i,<span class="dv">3</span>] =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span>R, <span class="dt">seed =</span> i)<span class="op">$</span>p.value</span>
<span id="cb32-43"><a href="#cb32-43"></a>}</span>
<span id="cb32-44"><a href="#cb32-44"></a></span>
<span id="cb32-45"><a href="#cb32-45"></a>alpha =<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb32-46"><a href="#cb32-46"></a>pow =<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb32-47"><a href="#cb32-47"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="kw">t</span>(pow), <span class="dt">row.names =</span> <span class="st">&quot;Power&quot;</span>), <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>, <span class="st">&quot;Energy&quot;</span>, <span class="st">&quot;Ball&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NN</th>
<th align="right">Energy</th>
<th align="right">Ball</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Power</td>
<td align="right">0.4</td>
<td align="right">0.61</td>
<td align="right">0.92</td>
</tr>
</tbody>
</table>
<p><strong>Case2: Unequal variances and unequal expectations</strong></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>mu =<span class="st"> </span><span class="fl">0.3</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>p.values =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,m,<span class="dv">3</span>)</span>
<span id="cb33-3"><a href="#cb33-3"></a></span>
<span id="cb33-4"><a href="#cb33-4"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb33-5"><a href="#cb33-5"></a>x =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p, <span class="dv">0</span>, <span class="fl">1.5</span>), <span class="dt">ncol =</span> p)</span>
<span id="cb33-6"><a href="#cb33-6"></a>y =<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span>mu))</span>
<span id="cb33-7"><a href="#cb33-7"></a>z =<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb33-8"><a href="#cb33-8"></a></span>
<span id="cb33-9"><a href="#cb33-9"></a>p.values[i,<span class="dv">1</span>] =<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb33-10"><a href="#cb33-10"></a>p.values[i,<span class="dv">2</span>] =<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb33-11"><a href="#cb33-11"></a>p.values[i,<span class="dv">3</span>] =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span>R, <span class="dt">seed =</span> i)<span class="op">$</span>p.value</span>
<span id="cb33-12"><a href="#cb33-12"></a>}</span>
<span id="cb33-13"><a href="#cb33-13"></a></span>
<span id="cb33-14"><a href="#cb33-14"></a>alpha =<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb33-15"><a href="#cb33-15"></a>pow =<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb33-16"><a href="#cb33-16"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="kw">t</span>(pow), <span class="dt">row.names =</span> <span class="st">&quot;Power&quot;</span>), <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>, <span class="st">&quot;Energy&quot;</span>, <span class="st">&quot;Ball&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NN</th>
<th align="right">Energy</th>
<th align="right">Ball</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Power</td>
<td align="right">0.52</td>
<td align="right">0.66</td>
<td align="right">0.96</td>
</tr>
</tbody>
</table>
<p><strong>Case3: Non-normal distributions: <span class="math inline">\(\mathrm{t}\)</span> distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions)</strong></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb34-2"><a href="#cb34-2"></a>x =<span class="st"> </span><span class="kw">matrix</span>(<span class="fl">0.5</span><span class="op">*</span><span class="kw">rnorm</span>(n1<span class="op">*</span>p, <span class="fl">-0.1</span>, <span class="dv">3</span>)<span class="op">+</span><span class="fl">0.5</span><span class="op">*</span><span class="kw">rnorm</span>(n1<span class="op">*</span>p, <span class="fl">0.1</span>, <span class="dv">3</span>), <span class="dt">ncol =</span> p)</span>
<span id="cb34-3"><a href="#cb34-3"></a>y =<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rt</span>(n2, <span class="dt">df =</span> <span class="dv">1</span>), <span class="kw">rt</span>(n2, <span class="dt">df =</span> <span class="dv">1</span>))</span>
<span id="cb34-4"><a href="#cb34-4"></a>z =<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb34-5"><a href="#cb34-5"></a></span>
<span id="cb34-6"><a href="#cb34-6"></a></span>
<span id="cb34-7"><a href="#cb34-7"></a>p.values[i,<span class="dv">1</span>] =<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb34-8"><a href="#cb34-8"></a>p.values[i,<span class="dv">2</span>] =<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb34-9"><a href="#cb34-9"></a>p.values[i,<span class="dv">3</span>] =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span>R, <span class="dt">seed =</span> i)<span class="op">$</span>p.value</span>
<span id="cb34-10"><a href="#cb34-10"></a>}</span>
<span id="cb34-11"><a href="#cb34-11"></a></span>
<span id="cb34-12"><a href="#cb34-12"></a>alpha =<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb34-13"><a href="#cb34-13"></a>pow =<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb34-14"><a href="#cb34-14"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="kw">t</span>(pow), <span class="dt">row.names =</span> <span class="st">&quot;Power&quot;</span>), <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>, <span class="st">&quot;Energy&quot;</span>, <span class="st">&quot;Ball&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NN</th>
<th align="right">Energy</th>
<th align="right">Ball</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Power</td>
<td align="right">0.52</td>
<td align="right">0.64</td>
<td align="right">0.49</td>
</tr>
</tbody>
</table>
<p><strong>Case4: Unbalanced samples (say, 1 case versus 10 controls)</strong></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>n1 =<span class="st"> </span><span class="dv">5</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>n2 =<span class="st"> </span><span class="dv">50</span></span>
<span id="cb35-3"><a href="#cb35-3"></a>n =<span class="st"> </span>n1<span class="op">+</span>n2; N =<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb35-4"><a href="#cb35-4"></a>p.values =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,m,<span class="dv">3</span>)</span>
<span id="cb35-5"><a href="#cb35-5"></a></span>
<span id="cb35-6"><a href="#cb35-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb35-7"><a href="#cb35-7"></a>x =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>p, <span class="dv">0</span>, <span class="fl">1.5</span>), <span class="dt">ncol =</span> p)</span>
<span id="cb35-8"><a href="#cb35-8"></a>y =<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">rnorm</span>(n2),<span class="kw">rnorm</span>(n2,<span class="dt">mean=</span>mu))</span>
<span id="cb35-9"><a href="#cb35-9"></a>z =<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb35-10"><a href="#cb35-10"></a></span>
<span id="cb35-11"><a href="#cb35-11"></a>p.values[i,<span class="dv">1</span>] =<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb35-12"><a href="#cb35-12"></a>p.values[i,<span class="dv">2</span>] =<span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb35-13"><a href="#cb35-13"></a>p.values[i,<span class="dv">3</span>] =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">num.permutations=</span>R, <span class="dt">seed =</span> i)<span class="op">$</span>p.value</span>
<span id="cb35-14"><a href="#cb35-14"></a>}</span>
<span id="cb35-15"><a href="#cb35-15"></a></span>
<span id="cb35-16"><a href="#cb35-16"></a>alpha =<span class="st"> </span><span class="fl">0.1</span>;</span>
<span id="cb35-17"><a href="#cb35-17"></a>pow =<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb35-18"><a href="#cb35-18"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="kw">t</span>(pow), <span class="dt">row.names =</span> <span class="st">&quot;Power&quot;</span>), <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;NN&quot;</span>, <span class="st">&quot;Energy&quot;</span>, <span class="st">&quot;Ball&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">NN</th>
<th align="right">Energy</th>
<th align="right">Ball</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Power</td>
<td align="right">0.36</td>
<td align="right">0.41</td>
<td align="right">0.18</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="hw-7-numerical-methods-in-r" class="section level1">
<h1>HW 7: Numerical methods in R</h1>
<div id="section-18" class="section level2">
<h2>9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
<p>Use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
<div id="solution.-15" class="section level3">
<h3>Solution.</h3>
<p><em>[Flowchart for random walk Metropolis sampler for generating the standard distribution]</em></p>
<ol style="list-style-type: decimal">
<li>Set <span class="math inline">\(g(\cdot \mid X)\)</span> to the density of <span class="math inline">\(N(X, \sigma^2)\)</span>.</li>
<li><span class="math inline">\(X_{0}\)</span> is generated from some distribution or manually chosen and stored in <span class="math inline">\({x}[1]\)</span>.</li>
<li>Repeat for <span class="math inline">\(i=2, \ldots, N\)</span> :
<ol style="list-style-type: decimal">
<li>Generate <span class="math inline">\(Y\)</span> from <span class="math inline">\(N\left(X_{t}, \sigma^2\right)=N(x[\mathrm{i}-1], \sigma^2)\)</span></li>
<li>Generate <span class="math inline">\(U\)</span> from <span class="math inline">\(U(0,1)\)</span></li>
<li>With <span class="math inline">\(X_{t}=x[\mathrm{i}-1],\)</span> compute <span class="math display">\[
r\left(X_{t}, Y\right)=\frac{f(Y) }{f\left(X_{t}\right) } = \frac{e^{-|Y|}}{e^{-|X_t|}}
\]</span> where <span class="math inline">\(f\)</span> is the Standard Laplace density with parameter. If <span class="math inline">\(U \leq r\left(X_{t}, Y\right)\)</span> accept <span class="math inline">\(Y\)</span> and set <span class="math inline">\(X_{t+1}=Y ;\)</span> otherwise set <span class="math inline">\(X_{t+1}=\)</span> <span class="math inline">\(X_{t} .\)</span> Store <span class="math inline">\(X_{t+1}\)</span> in <span class="math inline">\({x}[\mathrm{i}]\)</span>.</li>
</ol></li>
<li>Increment <span class="math inline">\(t\)</span>.</li>
</ol>
<p>Now we move to the code stage.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>dlaplace &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb36-2"><a href="#cb36-2"></a>  <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb36-3"><a href="#cb36-3"></a>}</span>
<span id="cb36-4"><a href="#cb36-4"></a></span>
<span id="cb36-5"><a href="#cb36-5"></a>rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb36-6"><a href="#cb36-6"></a>x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb36-7"><a href="#cb36-7"></a>x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb36-8"><a href="#cb36-8"></a>u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb36-9"><a href="#cb36-9"></a>k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb36-10"><a href="#cb36-10"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb36-11"><a href="#cb36-11"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb36-12"><a href="#cb36-12"></a><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dlaplace</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">dlaplace</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb36-13"><a href="#cb36-13"></a>x[i] &lt;-<span class="st"> </span>y </span>
<span id="cb36-14"><a href="#cb36-14"></a><span class="cf">else</span> {</span>
<span id="cb36-15"><a href="#cb36-15"></a>x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb36-16"><a href="#cb36-16"></a>k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb36-17"><a href="#cb36-17"></a>}</span>
<span id="cb36-18"><a href="#cb36-18"></a>}</span>
<span id="cb36-19"><a href="#cb36-19"></a></span>
<span id="cb36-20"><a href="#cb36-20"></a><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb36-21"><a href="#cb36-21"></a>}</span>
<span id="cb36-22"><a href="#cb36-22"></a></span>
<span id="cb36-23"><a href="#cb36-23"></a>N &lt;-<span class="st"> </span><span class="dv">4000</span></span>
<span id="cb36-24"><a href="#cb36-24"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb36-25"><a href="#cb36-25"></a>x0 &lt;-<span class="st"> </span><span class="dv">25</span></span>
<span id="cb36-26"><a href="#cb36-26"></a>rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb36-27"><a href="#cb36-27"></a>rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb36-28"><a href="#cb36-28"></a>rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb36-29"><a href="#cb36-29"></a>rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb36-30"><a href="#cb36-30"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb36-31"><a href="#cb36-31"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="kw">t</span>(<span class="kw">paste</span>(<span class="kw">round</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k)<span class="op">/</span>N, <span class="dv">4</span>)<span class="op">*</span><span class="dv">100</span>, <span class="st">&quot;%&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)), <span class="dt">row.names =</span> <span class="st">&quot;Accpectance Rate&quot;</span>), <span class="dt">col.names =</span> <span class="kw">paste</span>(<span class="st">&quot;sigma:&quot;</span>, sigma))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">sigma: 0.05</th>
<th align="left">sigma: 0.5</th>
<th align="left">sigma: 2</th>
<th align="left">sigma: 16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Accpectance Rate</td>
<td align="left">97.62%</td>
<td align="left">84.33%</td>
<td align="left">51.9%</td>
<td align="left">10%</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb37-2"><a href="#cb37-2"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb37-3"><a href="#cb37-3"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb37-4"><a href="#cb37-4"></a>psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb37-5"><a href="#cb37-5"></a>n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb37-6"><a href="#cb37-6"></a>k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb37-7"><a href="#cb37-7"></a>psi.means &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb37-8"><a href="#cb37-8"></a>B &lt;-<span class="st"> </span>n <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb37-9"><a href="#cb37-9"></a>psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb37-10"><a href="#cb37-10"></a>W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb37-11"><a href="#cb37-11"></a>v.hat &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb37-12"><a href="#cb37-12"></a>r.hat &lt;-<span class="st"> </span>v.hat <span class="op">/</span><span class="st"> </span>W <span class="co">#G-R statistic</span></span>
<span id="cb37-13"><a href="#cb37-13"></a><span class="kw">return</span>(r.hat)</span>
<span id="cb37-14"><a href="#cb37-14"></a>}</span>
<span id="cb37-15"><a href="#cb37-15"></a></span>
<span id="cb37-16"><a href="#cb37-16"></a></span>
<span id="cb37-17"><a href="#cb37-17"></a>k &lt;-<span class="st"> </span><span class="dv">4</span></span>
<span id="cb37-18"><a href="#cb37-18"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb37-19"><a href="#cb37-19"></a></span>
<span id="cb37-20"><a href="#cb37-20"></a>N &lt;-<span class="st"> </span><span class="dv">4000</span></span>
<span id="cb37-21"><a href="#cb37-21"></a>sigma &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb37-22"><a href="#cb37-22"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">-5</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb37-23"><a href="#cb37-23"></a>rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma, x0[<span class="dv">1</span>], N)</span>
<span id="cb37-24"><a href="#cb37-24"></a>rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma, x0[<span class="dv">2</span>], N)</span>
<span id="cb37-25"><a href="#cb37-25"></a>rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma, x0[<span class="dv">3</span>], N)</span>
<span id="cb37-26"><a href="#cb37-26"></a>rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma, x0[<span class="dv">4</span>], N)</span>
<span id="cb37-27"><a href="#cb37-27"></a></span>
<span id="cb37-28"><a href="#cb37-28"></a>rw &lt;-<span class="st"> </span><span class="kw">list</span>(rw1, rw2, rw3, rw4)</span>
<span id="cb37-29"><a href="#cb37-29"></a>X &lt;-<span class="st"> </span><span class="kw">rbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x, rw4<span class="op">$</span>x)</span>
<span id="cb37-30"><a href="#cb37-30"></a></span>
<span id="cb37-31"><a href="#cb37-31"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb37-32"><a href="#cb37-32"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb37-33"><a href="#cb37-33"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi))</span>
<span id="cb37-34"><a href="#cb37-34"></a>psi[i,] &lt;-<span class="st"> </span>psi[i,] <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb37-35"><a href="#cb37-35"></a><span class="kw">print</span>(<span class="kw">Gelman.Rubin</span>(psi))</span>
<span id="cb37-36"><a href="#cb37-36"></a><span class="co">#&gt; [1] 1.075986</span></span>
<span id="cb37-37"><a href="#cb37-37"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb37-38"><a href="#cb37-38"></a></span>
<span id="cb37-39"><a href="#cb37-39"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb37-40"><a href="#cb37-40"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</span>
<span id="cb37-41"><a href="#cb37-41"></a><span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb37-42"><a href="#cb37-42"></a><span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co">#par(mfrow=c(1,1)) #restore default</span></span>
<span id="cb38-2"><a href="#cb38-2"></a></span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb38-4"><a href="#cb38-4"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N)</span>
<span id="cb38-6"><a href="#cb38-6"></a>rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb38-7"><a href="#cb38-7"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>N], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb38-8"><a href="#cb38-8"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-19" class="section level2">
<h2>11.4</h2>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0, \sqrt{k})\)</span> of the curves <span class="math display">\[
S_{k-1}(a)=P\left(t(k-1)&gt;\sqrt{\frac{a^{2}(k-1)}{k-a^{2}}}\right)
\]</span> and <span class="math display">\[
S_{k}(a)=P\left(t(k)&gt;\sqrt{\frac{a^{2} k}{k+1-a^{2}}}\right)
\]</span></p>
<p>for <span class="math inline">\(k=4: 25,100,500,1000\)</span>, where <span class="math inline">\(t(k)\)</span> is a Student <span class="math inline">\(t\)</span> random variable with <span class="math inline">\(k\)</span> degrees of freedom. (These intersection points determine the critical values for a <span class="math inline">\(t\)</span> -test for scale-mixture errors proposed by Székely [260].)</p>
<div id="solution.-16" class="section level3">
<h3>Solution.</h3>
<p>Firstly, we define a function of <span class="math inline">\(a\)</span> with a fixed <span class="math inline">\(k\)</span>,</p>
<p><span class="math display">\[
g_k(a) = S_k(a) - S_{k-1}(a)
\]</span></p>
<p>So if we want to find the intersection points <span class="math inline">\(A(k)\)</span>, we can define <span class="math inline">\(A(k)\)</span> as</p>
<p><span class="math display">\[
A(k) = \operatorname{arg}_{a\in(0, \sqrt{k})}\{g_k(a)=0\}
\]</span></p>
<p>In order to offer convenience to finding the root, we firstly plot <span class="math inline">\(g_k(a)\)</span> w.r.t. different <span class="math inline">\(k\)</span>.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>gka =<span class="st"> </span><span class="cf">function</span>(k, a){</span>
<span id="cb39-2"><a href="#cb39-2"></a>  <span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k<span class="dv">-1</span>)<span class="op">/</span>(k<span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)), <span class="dt">df =</span> k<span class="dv">-1</span>) <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>(k)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)), <span class="dt">df =</span> k)</span>
<span id="cb39-3"><a href="#cb39-3"></a>}</span>
<span id="cb39-4"><a href="#cb39-4"></a></span>
<span id="cb39-5"><a href="#cb39-5"></a>plot.gka =<span class="st"> </span><span class="cf">function</span>(k, plot.dim){</span>
<span id="cb39-6"><a href="#cb39-6"></a>  <span class="co">#plot.dim is a 2-dim vector for plots</span></span>
<span id="cb39-7"><a href="#cb39-7"></a>  <span class="co">#par(mfrow=plot.dim)</span></span>
<span id="cb39-8"><a href="#cb39-8"></a>  n =<span class="st"> </span><span class="kw">length</span>(k)</span>
<span id="cb39-9"><a href="#cb39-9"></a>  </span>
<span id="cb39-10"><a href="#cb39-10"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb39-11"><a href="#cb39-11"></a>    a =<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="kw">sqrt</span>(k[i]), <span class="dt">length.out =</span> <span class="dv">50</span>)[<span class="op">-</span><span class="dv">50</span>]</span>
<span id="cb39-12"><a href="#cb39-12"></a>    <span class="kw">plot</span>(<span class="dt">x =</span> a, <span class="dt">y =</span> <span class="kw">gka</span>(k[i], a), <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb39-13"><a href="#cb39-13"></a>    <span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(g))</span>
<span id="cb39-14"><a href="#cb39-14"></a>    <span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span>
<span id="cb39-15"><a href="#cb39-15"></a>  }</span>
<span id="cb39-16"><a href="#cb39-16"></a>  </span>
<span id="cb39-17"><a href="#cb39-17"></a>  <span class="co">#par(mfrow=c(1,1)) #restore default</span></span>
<span id="cb39-18"><a href="#cb39-18"></a>  </span>
<span id="cb39-19"><a href="#cb39-19"></a>}</span>
<span id="cb39-20"><a href="#cb39-20"></a></span>
<span id="cb39-21"><a href="#cb39-21"></a><span class="kw">plot.gka</span>(<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">12</span>, <span class="dv">24</span>), <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="kw">plot.gka</span>(<span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>), <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAS1BMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6Ojo6ZmY6kNtmAABmtv+QOgCQZgCQ2/+2ZgC2///bkDrb////tmb/25D//7b//9v///949IFWAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAFvUlEQVR4nO3d6ULjNgAAYW8puy0sJWsM5P2ftLGdC4g0EvgQ0cyf0qaW228d3zbN1qI1a/8HlJ5AkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBAkECQQJBA0MRAzbdpLaBph5svgSCBoJmAXh/GL/BffzKGKxJtHqC2uRt/6A4/JAyXvj5cslmAXh+OLO3NU+pwFQG93P8+/NgFvmQfh2vK/I6VswTVBLRbB+0XofR1UJM7j4WaaSv2cj9uxQLLj0DZwzVzzGSKBIJK2VGsDCh/R7EuoE9s5pv8uSxTKTuKdQG5BFH5O4qVAeXvKDaBf756Ze0HCRQargl9sHozAoU2YJeGEwiGa4KfrF15QIWdWZwLqB23Yj8e343y9ppcs91fmzteo5vxCmB+25w/rVmWoObt35aYQJBA0Lr7QQLBcFUD7Q7Hbp42gWNVgbbdj8f25unlPno0XzFQf0qoPxfURk+YVQzUn1TsgeJnFCsGOixBm+gZxYqB9uug46nFwHDFngY6NutW7OOx2PvhagZKGk4gGK5aoNRLz7UCJV96LvZqz7GVLxxWCpR+6blSIJcgKvnSc61AyZeeqwVKHU4gGE4gGE4gGE4gGO7qgA5bp12BEz158706oP2OTdf8Dp6Ozxru6oBeH/4e/tqfLAzu42TM9+qADkdZu0Os6JXl1PleHdDhKKtfgj4D9ObWktOw1wN0WgcdvmxfnO/VAY3bsd3Cs/nSN+yKgSaer0AwnEAwXDPD2JMmECQQNNNJe9zLrh3o31s4Uqsd6G7bNtEdSYH63e2IkUBDXfDqvECJwwkEw9UJlDGcQDBcrUDJ7+6oFCj93R11AmW8eaFOoIx3d9QJlPPujqZsn9nWQcnv7qgTKOPdHZUCpQ9XM9DZqig8nEAwnEAwnEAwnEAwXM1Al0Z5f3dHxUApz81vKwZKem5+Wy9Q2nPzww9F+8wGlPbc/LZeoLTn5rf1AiU+N18xUNpz8zUDJQ4nEAwnEAwnEA1X1nslPzTTVY3TMRe+kbxGoN1eEN1mXjnQFh9UqB2of5ojcbiyfUpYSU878NQJBK1+ylUgGk4gGE4gGE6gqYZbp/W3YoUnECQQtBrQt2klIBo0+MmEH3xmknACQQJBAkECQQJBAkECQQJB3+bYYK0EggSCBIIEggSCBIIEggSCBIIEggSCBIKmB+pCN+KP94BmvGz4+defrMmGd9PcfWZOkSYH6nY63UWh55+hBxgu93I/3DKaPNnrw262w1v6cucUa2qg8c6GzaU/vcx3nR/eJJc82fNtf/9k/yTb196q/rapgU7/lR9qs5b5rrkb/z/zJhuW3sxJok0ONCzdF/8IN//sVxGpjaNkTta/MTx7TpGmBhpXP5dWQuObYIOPA18aqwfKnKx/L03+nCItB7T/PGP1cPbvpk7WnbZdE62IFvyKjZ/fpv/ql7NREic7f69RzpwiLbiSHj/P2AKfAyVN1p6veCba1i+3mR/psr9iGZMdnqTNn1OkBXcUB7XslXT6ZM/Hl11nzynS9IcabfCZ302T98un9stA6mTteOtYP/PcOUXyYBUSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBII+g5AoffDL9I3AOrCv85sgcoHGn7TyXqzLx+ovflPoEjPPx9dB0Xqb+kTKFLst5wsUuFAw62qAoXb33c41Q2Hn6hwoCGXIEggSKCSEwgSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCBIIEggSCPofb+jV3lpcRmQAAAAASUVORK5CYII=" /><!-- --></p>
<p>From the above, we see that <span class="math inline">\(g_k = 0\)</span> generally possess a unique root on <span class="math inline">\((0, \sqrt{k})\)</span>.</p>
<p>Now we try to get them.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="kw">library</span>(<span class="st">&quot;kableExtra&quot;</span>)</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="co">#&gt; Warning: package &#39;kableExtra&#39; was built under R version 4.0.3</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>k =<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb41-4"><a href="#cb41-4"></a>n =<span class="st"> </span><span class="kw">length</span>(k)</span>
<span id="cb41-5"><a href="#cb41-5"></a>res =<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb41-6"><a href="#cb41-6"></a></span>
<span id="cb41-7"><a href="#cb41-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb41-8"><a href="#cb41-8"></a>  res[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(<span class="cf">function</span>(a) {</span>
<span id="cb41-9"><a href="#cb41-9"></a><span class="kw">gka</span>(k[i], a) },</span>
<span id="cb41-10"><a href="#cb41-10"></a><span class="dt">lower =</span> <span class="fl">0.1</span>, <span class="dt">upper =</span> <span class="kw">min</span>(<span class="kw">sqrt</span>(k[i])<span class="op">-</span><span class="fl">0.1</span>, <span class="dv">5</span>))<span class="op">$</span>root</span>
<span id="cb41-11"><a href="#cb41-11"></a>}</span>
<span id="cb41-12"><a href="#cb41-12"></a></span>
<span id="cb41-13"><a href="#cb41-13"></a>dt =<span class="st"> </span><span class="kw">t</span>(<span class="kw">data.frame</span>(<span class="st">&quot;k&quot;</span> =<span class="st"> </span><span class="kw">as.character</span>(k), <span class="st">&quot;root&quot;</span> =<span class="st"> </span>res))</span>
<span id="cb41-14"><a href="#cb41-14"></a></span>
<span id="cb41-15"><a href="#cb41-15"></a><span class="kw">kbl</span>(dt) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">kable_paper</span>() <span class="op">%&gt;%</span></span>
<span id="cb41-16"><a href="#cb41-16"></a><span class="st">  </span><span class="kw">scroll_box</span>(<span class="dt">width =</span> <span class="st">&quot;900px&quot;</span>, <span class="dt">height =</span> <span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:900px; ">
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
k
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:left;">
8
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:left;">
11
</td>
<td style="text-align:left;">
12
</td>
<td style="text-align:left;">
13
</td>
<td style="text-align:left;">
14
</td>
<td style="text-align:left;">
15
</td>
<td style="text-align:left;">
16
</td>
<td style="text-align:left;">
17
</td>
<td style="text-align:left;">
18
</td>
<td style="text-align:left;">
19
</td>
<td style="text-align:left;">
20
</td>
<td style="text-align:left;">
21
</td>
<td style="text-align:left;">
22
</td>
<td style="text-align:left;">
23
</td>
<td style="text-align:left;">
24
</td>
<td style="text-align:left;">
25
</td>
<td style="text-align:left;">
100
</td>
<td style="text-align:left;">
500
</td>
<td style="text-align:left;">
1000
</td>
</tr>
<tr>
<td style="text-align:left;">
root
</td>
<td style="text-align:left;">
1.492103
</td>
<td style="text-align:left;">
1.533582
</td>
<td style="text-align:left;">
1.562744
</td>
<td style="text-align:left;">
1.584429
</td>
<td style="text-align:left;">
1.601183
</td>
<td style="text-align:left;">
1.614536
</td>
<td style="text-align:left;">
1.625366
</td>
<td style="text-align:left;">
1.634415
</td>
<td style="text-align:left;">
1.642017
</td>
<td style="text-align:left;">
1.648547
</td>
<td style="text-align:left;">
1.654170
</td>
<td style="text-align:left;">
1.659098
</td>
<td style="text-align:left;">
1.663444
</td>
<td style="text-align:left;">
1.667283
</td>
<td style="text-align:left;">
1.670738
</td>
<td style="text-align:left;">
1.673795
</td>
<td style="text-align:left;">
1.676614
</td>
<td style="text-align:left;">
1.679154
</td>
<td style="text-align:left;">
1.681472
</td>
<td style="text-align:left;">
1.683594
</td>
<td style="text-align:left;">
1.685569
</td>
<td style="text-align:left;">
1.687336
</td>
<td style="text-align:left;">
1.720599
</td>
<td style="text-align:left;">
1.729745
</td>
<td style="text-align:left;">
1.730896
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="hw-8-r-programming-techniques" class="section level1">
<h1>HW 8: R programming techniques</h1>
<div id="question-1." class="section level2">
<h2>Question 1.</h2>
<p><strong>A-B-O blood type problem</strong></p>
<ul>
<li>Let the three alleles be <span class="math inline">\(A, B,\)</span> and <span class="math inline">\(O\)</span>.</li>
<li>Observed data: <span class="math inline">\(n_{A \cdot}=n_{A A}+n_{A O}=444\)</span> (<span class="math inline">\(\mathrm{~A}\)</span>-type) <span class="math inline">\(n_{B}=n_{B B}+n_{B O}=132(\mathrm{~B}\)</span>-type <span class="math inline">\(), n_{O O}=361(\mathrm{O}\)</span>-type <span class="math inline">\()\)</span> <span class="math inline">\(n_{A B}=63(\mathrm{AB}-\mathrm{type})\)</span></li>
<li>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> (consider missing data <span class="math inline">\(n_{A A}\)</span> and <span class="math inline">\(\left.n_{B B}\right)\)</span></li>
<li>Record the values of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</li>
</ul>
<div id="solution.-17" class="section level3">
<h3>Solution.</h3>
<p>[<em>EM Algorithm Flowchart</em>]</p>
<ol style="list-style-type: decimal">
<li><p>Initiate <span class="math inline">\((p, q)\)</span> with <span class="math inline">\((p_0,q_0)\)</span>.</p></li>
<li><p><strong>E-step</strong>: <span class="math inline">\(l_{0}\left(p, q; n_A, n_B, n_{OO}, n_{AB}\right)=E_{p_{0}, q_0}\left[\log L\left(p,q;n_{AA}, n_{BB}, n_{OO}, n_{AO}, n_{BO},n_{AB}\right) \mid n_A, n_B, n_{OO}, n_{AB}\right]\)</span></p></li>
<li><p><strong>M-step</strong>: maximize <span class="math inline">\(l_{0}\)</span> w.r.t. <span class="math inline">\(p,q\)</span>, let the resultant maximizer be <span class="math inline">\(p_{1}, q_1\)</span>.</p></li>
<li><p>In steps 2 and 3, replace <span class="math inline">\(p_0, q_0\)</span> with <span class="math inline">\(p_1, q_1\)</span>, and repeat this process until convergence (iteration).</p></li>
</ol>
<p>Now give some details of <strong>E-step</strong> and the <strong>M-step</strong>.</p>
<p><strong>E-step</strong>:</p>
<p><span class="math display">\[
\begin{aligned}
&amp;l_{0}\left(p, q; n_A, n_B, n_{OO}, n_{AB}\right) \\=&amp; E_{p_{0}, q_0}\left[2n_{AA}\log p+2n_{BB} \log q + 2n_{OO} \log r+n_{AO}\log 2pr+n_{BO} \log 2qr+ n_{AB}\log 2pq\mid n_A, n_B, n_{OO}, n_{AB}\right]
\end{aligned}
\]</span></p>
<p>Meanwhile,</p>
<p><span class="math display">\[
\begin{aligned}
n_{AA}|n_A \sim B\left(n_A, \frac{p^2}{p^2+2pr}\right)\\
n_{AO}|n_A \sim B\left(n_A, \frac{2pr}{p^2+2pr}\right)\\
n_{BB}|n_B \sim B\left(n_B, \frac{q^2}{q^2+2qr}\right)\\
n_{BO}|n_B \sim B\left(n_B, \frac{2qr}{q^2+2qr}\right)\\
\end{aligned}
\]</span></p>
<p>As a result,</p>
<p><span class="math display">\[
\begin{aligned}
l_0 = &amp;2n_A\log p\cdot \frac{p_0^2}{p_0^2+2p_0r_0} + n_A\log 2pr \cdot \frac{2p_0r_0}{p_0^2+2p_0r_0}\\
+ &amp;2n_B\log q\cdot \frac{q_0^2}{q_0^2+2q_0r_0} + n_B\log 2qr \cdot \frac{2q_0r_0}{q_0^2+2q_0r_0}\\
+&amp;2n_{OO}\log r+n_{AB}\log 2pq
\end{aligned}
\]</span></p>
<p><strong>M-step</strong></p>
<p>Let <span class="math display">\[
\begin{aligned}
\frac{\partial l_0}{\partial p} = 0\\
\frac{\partial l_0}{\partial q} = 0\\
\end{aligned}
\]</span></p>
<p>Then we have formulae</p>
<p><span class="math display">\[
\begin{aligned}
A_1 r = B_1 p\\
A_2 r = B_2 q
\end{aligned}
\]</span></p>
<p>where</p>
<p><span class="math display">\[
\begin{aligned}
A_1 =&amp; n_A+n_{AB} +n_A\frac{p_0}{p_0+2r_0}\\
B_1 =&amp; 2n_{OO}+2n_A\frac{r_0}{p_0+2r_0}+2n_B\frac{r_0}{q_0+2r_0}\\
A_2 =&amp; n_B+n_{AB} +n_B\frac{q_0}{q_0+2r_0}\\
B_2 =&amp; B_1 = B\\
\end{aligned}
\]</span></p>
<p>As a result,</p>
<p><span class="math display">\[
\begin{aligned}
p = \frac{A_1}{A_1+A_2+B}\\
q = \frac{A_2}{A_1+A_2+B}
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co">#Known Parameters</span></span>
<span id="cb42-2"><a href="#cb42-2"></a>na =<span class="st"> </span><span class="dv">444</span></span>
<span id="cb42-3"><a href="#cb42-3"></a>nb =<span class="st"> </span><span class="dv">132</span></span>
<span id="cb42-4"><a href="#cb42-4"></a>noo =<span class="st"> </span><span class="dv">361</span></span>
<span id="cb42-5"><a href="#cb42-5"></a>nab =<span class="st"> </span><span class="dv">63</span></span>
<span id="cb42-6"><a href="#cb42-6"></a></span>
<span id="cb42-7"><a href="#cb42-7"></a><span class="co">#EM Algorithm</span></span>
<span id="cb42-8"><a href="#cb42-8"></a></span>
<span id="cb42-9"><a href="#cb42-9"></a>para.old =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.4</span>, <span class="fl">0.4</span>)</span>
<span id="cb42-10"><a href="#cb42-10"></a>para.ma =<span class="st"> </span><span class="kw">matrix</span>(para.old, <span class="dt">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb42-11"><a href="#cb42-11"></a>para =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>)</span>
<span id="cb42-12"><a href="#cb42-12"></a>thres =<span class="st"> </span><span class="fl">1e-6</span></span>
<span id="cb42-13"><a href="#cb42-13"></a></span>
<span id="cb42-14"><a href="#cb42-14"></a><span class="cf">while</span> (<span class="kw">sum</span>((para<span class="op">-</span>para.old)<span class="op">^</span><span class="dv">2</span>)<span class="op">&gt;</span>thres) {</span>
<span id="cb42-15"><a href="#cb42-15"></a>  para.old =<span class="st"> </span>para</span>
<span id="cb42-16"><a href="#cb42-16"></a>  r0 =<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(para.old)</span>
<span id="cb42-17"><a href="#cb42-17"></a>  <span class="co">#Update p, q</span></span>
<span id="cb42-18"><a href="#cb42-18"></a>  A1 =<span class="st"> </span>na<span class="op">+</span>nab<span class="op">+</span>na<span class="op">*</span>para.old[<span class="dv">1</span>]<span class="op">/</span>(para.old[<span class="dv">1</span>]<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r0)</span>
<span id="cb42-19"><a href="#cb42-19"></a>  A2 =<span class="st"> </span>nb<span class="op">+</span>nab<span class="op">+</span>nb<span class="op">*</span>para.old[<span class="dv">2</span>]<span class="op">/</span>(para.old[<span class="dv">2</span>]<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r0)</span>
<span id="cb42-20"><a href="#cb42-20"></a>  B =<span class="st"> </span><span class="dv">2</span><span class="op">*</span>noo<span class="op">+</span><span class="dv">2</span><span class="op">*</span>na<span class="op">*</span>r0<span class="op">/</span>(para.old[<span class="dv">1</span>]<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r0)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nb<span class="op">*</span>r0<span class="op">/</span>(para.old[<span class="dv">2</span>]<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r0)</span>
<span id="cb42-21"><a href="#cb42-21"></a>  para[<span class="dv">1</span>] =<span class="st"> </span>A1<span class="op">/</span>(A1<span class="op">+</span>A2<span class="op">+</span>B)</span>
<span id="cb42-22"><a href="#cb42-22"></a>  para[<span class="dv">2</span>] =<span class="st"> </span>A2<span class="op">/</span>(A1<span class="op">+</span>A2<span class="op">+</span>B)</span>
<span id="cb42-23"><a href="#cb42-23"></a>  para.ma =<span class="st"> </span><span class="kw">cbind</span>(para.ma, para)</span>
<span id="cb42-24"><a href="#cb42-24"></a>}</span>
<span id="cb42-25"><a href="#cb42-25"></a></span>
<span id="cb42-26"><a href="#cb42-26"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="kw">t</span>(<span class="kw">round</span>(para, <span class="dv">3</span>)), <span class="dt">row.names =</span> <span class="st">&quot;Estimate&quot;</span>), <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;q&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
p
</th>
<th style="text-align:right;">
q
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Estimate
</td>
<td style="text-align:right;">
0.297
</td>
<td style="text-align:right;">
0.103
</td>
</tr>
</tbody>
</table>
<p>Also we calculate the observed data log likelihood corresponding to each update of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span>.</p>
<p><span class="math display">\[
l(p,q|n_A, n_B, n_{OO}, n_{AB}) ={n_A} \log(p^2+2pr)+n_B\log(q^2+2qr)+2n_{OO}\log r+n_{AB}\log 2pq
\]</span></p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>n =<span class="st"> </span><span class="kw">ncol</span>(para.ma)</span>
<span id="cb43-2"><a href="#cb43-2"></a>l =<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb43-4"><a href="#cb43-4"></a>  p =<span class="st"> </span>para.ma[<span class="dv">1</span>, i]</span>
<span id="cb43-5"><a href="#cb43-5"></a>  q =<span class="st"> </span>para.ma[<span class="dv">2</span>, i]</span>
<span id="cb43-6"><a href="#cb43-6"></a>  r =<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</span>
<span id="cb43-7"><a href="#cb43-7"></a>  l[i] =<span class="st"> </span>na<span class="op">*</span><span class="kw">log</span>(p<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r)<span class="op">+</span>nb<span class="op">*</span><span class="kw">log</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r)<span class="op">+</span><span class="dv">2</span><span class="op">*</span>noo<span class="op">*</span><span class="kw">log</span>(r)<span class="op">+</span>nab<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q)</span>
<span id="cb43-8"><a href="#cb43-8"></a>}</span>
<span id="cb43-9"><a href="#cb43-9"></a></span>
<span id="cb43-10"><a href="#cb43-10"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="kw">t</span>(<span class="kw">round</span>(l, <span class="dv">3</span>)), <span class="dt">row.names =</span> <span class="st">&quot;Log Likelihood&quot;</span>), <span class="dt">col.names =</span> <span class="dv">1</span><span class="op">:</span>n)</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
1
</th>
<th style="text-align:right;">
2
</th>
<th style="text-align:right;">
3
</th>
<th style="text-align:right;">
4
</th>
<th style="text-align:right;">
5
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Log Likelihood
</td>
<td style="text-align:right;">
-1890.113
</td>
<td style="text-align:right;">
-1174.092
</td>
<td style="text-align:right;">
-1169.951
</td>
<td style="text-align:right;">
-1169.826
</td>
<td style="text-align:right;">
-1169.822
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="exercise-3-page-204-advanced-r" class="section level2">
<h2>Exercise 3, Page 204, Advanced R</h2>
<p>Use both for loops and lapply() to fit linear models to the “mtcars” using the formulas stored in this list:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb44-2"><a href="#cb44-2"></a>mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb44-3"><a href="#cb44-3"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb44-4"><a href="#cb44-4"></a>mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb44-5"><a href="#cb44-5"></a>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb44-6"><a href="#cb44-6"></a>)</span></code></pre></div>
<div id="solution.-18" class="section level3">
<h3>Solution.</h3>
<div id="loops" class="section level4">
<h4>Loops</h4>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a>n =<span class="st"> </span><span class="kw">length</span>(formulas)</span>
<span id="cb45-2"><a href="#cb45-2"></a>model =<span class="st"> </span><span class="kw">list</span>(<span class="ot">NULL</span>)</span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb45-4"><a href="#cb45-4"></a>  model[[i]] =<span class="st"> </span><span class="kw">lm</span>(formulas[[i]], mtcars)</span>
<span id="cb45-5"><a href="#cb45-5"></a>}</span>
<span id="cb45-6"><a href="#cb45-6"></a>model</span>
<span id="cb45-7"><a href="#cb45-7"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb45-8"><a href="#cb45-8"></a><span class="co">#&gt; </span></span>
<span id="cb45-9"><a href="#cb45-9"></a><span class="co">#&gt; Call:</span></span>
<span id="cb45-10"><a href="#cb45-10"></a><span class="co">#&gt; lm(formula = formulas[[i]], data = mtcars)</span></span>
<span id="cb45-11"><a href="#cb45-11"></a><span class="co">#&gt; </span></span>
<span id="cb45-12"><a href="#cb45-12"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb45-13"><a href="#cb45-13"></a><span class="co">#&gt; (Intercept)         disp  </span></span>
<span id="cb45-14"><a href="#cb45-14"></a><span class="co">#&gt;    29.59985     -0.04122  </span></span>
<span id="cb45-15"><a href="#cb45-15"></a><span class="co">#&gt; </span></span>
<span id="cb45-16"><a href="#cb45-16"></a><span class="co">#&gt; </span></span>
<span id="cb45-17"><a href="#cb45-17"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb45-18"><a href="#cb45-18"></a><span class="co">#&gt; </span></span>
<span id="cb45-19"><a href="#cb45-19"></a><span class="co">#&gt; Call:</span></span>
<span id="cb45-20"><a href="#cb45-20"></a><span class="co">#&gt; lm(formula = formulas[[i]], data = mtcars)</span></span>
<span id="cb45-21"><a href="#cb45-21"></a><span class="co">#&gt; </span></span>
<span id="cb45-22"><a href="#cb45-22"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb45-23"><a href="#cb45-23"></a><span class="co">#&gt; (Intercept)    I(1/disp)  </span></span>
<span id="cb45-24"><a href="#cb45-24"></a><span class="co">#&gt;       10.75      1557.67  </span></span>
<span id="cb45-25"><a href="#cb45-25"></a><span class="co">#&gt; </span></span>
<span id="cb45-26"><a href="#cb45-26"></a><span class="co">#&gt; </span></span>
<span id="cb45-27"><a href="#cb45-27"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb45-28"><a href="#cb45-28"></a><span class="co">#&gt; </span></span>
<span id="cb45-29"><a href="#cb45-29"></a><span class="co">#&gt; Call:</span></span>
<span id="cb45-30"><a href="#cb45-30"></a><span class="co">#&gt; lm(formula = formulas[[i]], data = mtcars)</span></span>
<span id="cb45-31"><a href="#cb45-31"></a><span class="co">#&gt; </span></span>
<span id="cb45-32"><a href="#cb45-32"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb45-33"><a href="#cb45-33"></a><span class="co">#&gt; (Intercept)         disp           wt  </span></span>
<span id="cb45-34"><a href="#cb45-34"></a><span class="co">#&gt;    34.96055     -0.01772     -3.35083  </span></span>
<span id="cb45-35"><a href="#cb45-35"></a><span class="co">#&gt; </span></span>
<span id="cb45-36"><a href="#cb45-36"></a><span class="co">#&gt; </span></span>
<span id="cb45-37"><a href="#cb45-37"></a><span class="co">#&gt; [[4]]</span></span>
<span id="cb45-38"><a href="#cb45-38"></a><span class="co">#&gt; </span></span>
<span id="cb45-39"><a href="#cb45-39"></a><span class="co">#&gt; Call:</span></span>
<span id="cb45-40"><a href="#cb45-40"></a><span class="co">#&gt; lm(formula = formulas[[i]], data = mtcars)</span></span>
<span id="cb45-41"><a href="#cb45-41"></a><span class="co">#&gt; </span></span>
<span id="cb45-42"><a href="#cb45-42"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb45-43"><a href="#cb45-43"></a><span class="co">#&gt; (Intercept)    I(1/disp)           wt  </span></span>
<span id="cb45-44"><a href="#cb45-44"></a><span class="co">#&gt;      19.024     1142.560       -1.798</span></span></code></pre></div>
</div>
</div>
<div id="lapply" class="section level3">
<h3>lapply</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>model =<span class="st"> </span><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(fm) <span class="kw">lm</span>(fm, mtcars))</span>
<span id="cb46-2"><a href="#cb46-2"></a></span>
<span id="cb46-3"><a href="#cb46-3"></a>model</span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="co">#&gt; </span></span>
<span id="cb46-6"><a href="#cb46-6"></a><span class="co">#&gt; Call:</span></span>
<span id="cb46-7"><a href="#cb46-7"></a><span class="co">#&gt; lm(formula = fm, data = mtcars)</span></span>
<span id="cb46-8"><a href="#cb46-8"></a><span class="co">#&gt; </span></span>
<span id="cb46-9"><a href="#cb46-9"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb46-10"><a href="#cb46-10"></a><span class="co">#&gt; (Intercept)         disp  </span></span>
<span id="cb46-11"><a href="#cb46-11"></a><span class="co">#&gt;    29.59985     -0.04122  </span></span>
<span id="cb46-12"><a href="#cb46-12"></a><span class="co">#&gt; </span></span>
<span id="cb46-13"><a href="#cb46-13"></a><span class="co">#&gt; </span></span>
<span id="cb46-14"><a href="#cb46-14"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb46-15"><a href="#cb46-15"></a><span class="co">#&gt; </span></span>
<span id="cb46-16"><a href="#cb46-16"></a><span class="co">#&gt; Call:</span></span>
<span id="cb46-17"><a href="#cb46-17"></a><span class="co">#&gt; lm(formula = fm, data = mtcars)</span></span>
<span id="cb46-18"><a href="#cb46-18"></a><span class="co">#&gt; </span></span>
<span id="cb46-19"><a href="#cb46-19"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb46-20"><a href="#cb46-20"></a><span class="co">#&gt; (Intercept)    I(1/disp)  </span></span>
<span id="cb46-21"><a href="#cb46-21"></a><span class="co">#&gt;       10.75      1557.67  </span></span>
<span id="cb46-22"><a href="#cb46-22"></a><span class="co">#&gt; </span></span>
<span id="cb46-23"><a href="#cb46-23"></a><span class="co">#&gt; </span></span>
<span id="cb46-24"><a href="#cb46-24"></a><span class="co">#&gt; [[3]]</span></span>
<span id="cb46-25"><a href="#cb46-25"></a><span class="co">#&gt; </span></span>
<span id="cb46-26"><a href="#cb46-26"></a><span class="co">#&gt; Call:</span></span>
<span id="cb46-27"><a href="#cb46-27"></a><span class="co">#&gt; lm(formula = fm, data = mtcars)</span></span>
<span id="cb46-28"><a href="#cb46-28"></a><span class="co">#&gt; </span></span>
<span id="cb46-29"><a href="#cb46-29"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb46-30"><a href="#cb46-30"></a><span class="co">#&gt; (Intercept)         disp           wt  </span></span>
<span id="cb46-31"><a href="#cb46-31"></a><span class="co">#&gt;    34.96055     -0.01772     -3.35083  </span></span>
<span id="cb46-32"><a href="#cb46-32"></a><span class="co">#&gt; </span></span>
<span id="cb46-33"><a href="#cb46-33"></a><span class="co">#&gt; </span></span>
<span id="cb46-34"><a href="#cb46-34"></a><span class="co">#&gt; [[4]]</span></span>
<span id="cb46-35"><a href="#cb46-35"></a><span class="co">#&gt; </span></span>
<span id="cb46-36"><a href="#cb46-36"></a><span class="co">#&gt; Call:</span></span>
<span id="cb46-37"><a href="#cb46-37"></a><span class="co">#&gt; lm(formula = fm, data = mtcars)</span></span>
<span id="cb46-38"><a href="#cb46-38"></a><span class="co">#&gt; </span></span>
<span id="cb46-39"><a href="#cb46-39"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb46-40"><a href="#cb46-40"></a><span class="co">#&gt; (Intercept)    I(1/disp)           wt  </span></span>
<span id="cb46-41"><a href="#cb46-41"></a><span class="co">#&gt;      19.024     1142.560       -1.798</span></span></code></pre></div>
</div>
</div>
<div id="exercise-3-page-213-advanced-r" class="section level2">
<h2>Exercise 3, Page 213, Advanced R</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="dv">100</span>,</span>
<span id="cb47-3"><a href="#cb47-3"></a><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb47-4"><a href="#cb47-4"></a><span class="dt">simplify =</span> <span class="ot">FALSE</span></span>
<span id="cb47-5"><a href="#cb47-5"></a>)</span></code></pre></div>
<p>Extra challenge: get rid of the anonymous function by using [[ directly.</p>
<div id="solution.-19" class="section level3">
<h3>Solution.</h3>
</div>
<div id="anonymous-function" class="section level3">
<h3>Anonymous function</h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="kw">library</span>(<span class="st">&quot;kableExtra&quot;</span>)</span>
<span id="cb48-2"><a href="#cb48-2"></a>pvalues =<span class="st"> </span><span class="kw">sapply</span>(trials, <span class="cf">function</span>(test) test<span class="op">$</span>p.value)</span>
<span id="cb48-3"><a href="#cb48-3"></a></span>
<span id="cb48-4"><a href="#cb48-4"></a>dt =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(pvalues))</span>
<span id="cb48-5"><a href="#cb48-5"></a><span class="kw">row.names</span>(dt) =<span class="st"> &quot;p values&quot;</span></span>
<span id="cb48-6"><a href="#cb48-6"></a><span class="kw">kbl</span>(dt, <span class="dt">col.names =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dt">row.names =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">kable_paper</span>() <span class="op">%&gt;%</span></span>
<span id="cb48-7"><a href="#cb48-7"></a><span class="st">  </span><span class="kw">scroll_box</span>(<span class="dt">width =</span> <span class="st">&quot;900px&quot;</span>, <span class="dt">height =</span> <span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:900px; ">
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
5
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
6
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
7
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
8
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
9
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
10
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
11
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
12
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
13
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
14
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
15
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
16
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
17
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
18
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
19
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
20
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
21
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
22
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
23
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
24
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
25
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
26
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
27
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
28
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
29
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
30
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
31
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
32
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
33
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
34
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
35
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
36
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
37
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
38
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
39
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
40
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
41
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
42
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
43
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
44
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
45
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
46
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
47
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
48
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
49
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
50
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
51
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
52
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
53
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
54
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
55
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
56
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
57
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
58
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
59
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
60
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
61
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
62
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
63
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
64
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
65
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
66
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
67
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
68
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
69
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
70
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
71
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
72
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
73
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
74
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
75
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
76
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
77
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
78
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
79
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
80
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
81
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
82
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
83
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
84
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
85
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
86
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
87
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
88
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
89
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
90
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
91
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
92
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
93
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
94
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
95
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
96
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
98
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
99
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
100
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
p values
</td>
<td style="text-align:right;">
0.3989771
</td>
<td style="text-align:right;">
0.5190614
</td>
<td style="text-align:right;">
0.4601104
</td>
<td style="text-align:right;">
0.7923293
</td>
<td style="text-align:right;">
0.1553369
</td>
<td style="text-align:right;">
0.173587
</td>
<td style="text-align:right;">
0.0790656
</td>
<td style="text-align:right;">
0.1860229
</td>
<td style="text-align:right;">
0.4059915
</td>
<td style="text-align:right;">
0.3123312
</td>
<td style="text-align:right;">
0.8312241
</td>
<td style="text-align:right;">
0.2614934
</td>
<td style="text-align:right;">
0.2150162
</td>
<td style="text-align:right;">
0.2288642
</td>
<td style="text-align:right;">
0.0380427
</td>
<td style="text-align:right;">
0.43223
</td>
<td style="text-align:right;">
0.991392
</td>
<td style="text-align:right;">
0.9842236
</td>
<td style="text-align:right;">
0.6553651
</td>
<td style="text-align:right;">
0.6489628
</td>
<td style="text-align:right;">
0.4160079
</td>
<td style="text-align:right;">
0.5166883
</td>
<td style="text-align:right;">
0.4486036
</td>
<td style="text-align:right;">
0.6977665
</td>
<td style="text-align:right;">
0.313269
</td>
<td style="text-align:right;">
0.728477
</td>
<td style="text-align:right;">
0.5020349
</td>
<td style="text-align:right;">
0.201697
</td>
<td style="text-align:right;">
0.1753947
</td>
<td style="text-align:right;">
0.896115
</td>
<td style="text-align:right;">
0.5989986
</td>
<td style="text-align:right;">
0.5710472
</td>
<td style="text-align:right;">
0.7558466
</td>
<td style="text-align:right;">
0.2195294
</td>
<td style="text-align:right;">
0.5401385
</td>
<td style="text-align:right;">
0.1199292
</td>
<td style="text-align:right;">
0.6298002
</td>
<td style="text-align:right;">
0.517732
</td>
<td style="text-align:right;">
0.6144994
</td>
<td style="text-align:right;">
0.3236133
</td>
<td style="text-align:right;">
0.872392
</td>
<td style="text-align:right;">
0.5404297
</td>
<td style="text-align:right;">
0.9257846
</td>
<td style="text-align:right;">
0.768041
</td>
<td style="text-align:right;">
0.6887005
</td>
<td style="text-align:right;">
0.5524066
</td>
<td style="text-align:right;">
0.0055078
</td>
<td style="text-align:right;">
0.64871
</td>
<td style="text-align:right;">
0.1095004
</td>
<td style="text-align:right;">
0.9139441
</td>
<td style="text-align:right;">
0.3416851
</td>
<td style="text-align:right;">
0.1976245
</td>
<td style="text-align:right;">
0.589321
</td>
<td style="text-align:right;">
0.0166729
</td>
<td style="text-align:right;">
0.5960697
</td>
<td style="text-align:right;">
0.2079972
</td>
<td style="text-align:right;">
0.4576891
</td>
<td style="text-align:right;">
0.316089
</td>
<td style="text-align:right;">
0.4973581
</td>
<td style="text-align:right;">
0.418362
</td>
<td style="text-align:right;">
0.6014517
</td>
<td style="text-align:right;">
0.9855124
</td>
<td style="text-align:right;">
0.7720777
</td>
<td style="text-align:right;">
0.9034302
</td>
<td style="text-align:right;">
0.9187022
</td>
<td style="text-align:right;">
0.2816767
</td>
<td style="text-align:right;">
0.3206168
</td>
<td style="text-align:right;">
0.7993252
</td>
<td style="text-align:right;">
0.9092123
</td>
<td style="text-align:right;">
0.8600646
</td>
<td style="text-align:right;">
0.3676143
</td>
<td style="text-align:right;">
0.0729947
</td>
<td style="text-align:right;">
0.015052
</td>
<td style="text-align:right;">
0.1240839
</td>
<td style="text-align:right;">
0.383785
</td>
<td style="text-align:right;">
0.5825896
</td>
<td style="text-align:right;">
0.9049404
</td>
<td style="text-align:right;">
0.3011734
</td>
<td style="text-align:right;">
0.4145092
</td>
<td style="text-align:right;">
0.5620059
</td>
<td style="text-align:right;">
0.2985351
</td>
<td style="text-align:right;">
0.7497707
</td>
<td style="text-align:right;">
0.0886257
</td>
<td style="text-align:right;">
0.7717487
</td>
<td style="text-align:right;">
0.1529231
</td>
<td style="text-align:right;">
0.5590911
</td>
<td style="text-align:right;">
0.8497691
</td>
<td style="text-align:right;">
0.945478
</td>
<td style="text-align:right;">
0.4962063
</td>
<td style="text-align:right;">
0.2469868
</td>
<td style="text-align:right;">
0.535262
</td>
<td style="text-align:right;">
0.4095855
</td>
<td style="text-align:right;">
0.6413159
</td>
<td style="text-align:right;">
0.1588368
</td>
<td style="text-align:right;">
0.4722973
</td>
<td style="text-align:right;">
0.7148495
</td>
<td style="text-align:right;">
0.870844
</td>
<td style="text-align:right;">
0.9475619
</td>
<td style="text-align:right;">
0.8929779
</td>
<td style="text-align:right;">
0.0170991
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="section-20" class="section level3">
<h3>[[]]</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a>pvalues =<span class="st"> </span><span class="kw">sapply</span>(trials, <span class="st">&quot;[[&quot;</span>, <span class="dv">3</span>)</span>
<span id="cb49-2"><a href="#cb49-2"></a></span>
<span id="cb49-3"><a href="#cb49-3"></a>dt =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">t</span>(pvalues))</span>
<span id="cb49-4"><a href="#cb49-4"></a><span class="kw">row.names</span>(dt) =<span class="st"> &quot;p values&quot;</span></span>
<span id="cb49-5"><a href="#cb49-5"></a><span class="kw">kbl</span>(dt, <span class="dt">col.names =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dt">row.names =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">kable_paper</span>() <span class="op">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6"></a><span class="st">  </span><span class="kw">scroll_box</span>(<span class="dt">width =</span> <span class="st">&quot;900px&quot;</span>, <span class="dt">height =</span> <span class="st">&quot;100%&quot;</span>)</span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:100%; overflow-x: scroll; width:900px; ">
<table class=" lightable-paper" style="font-family: &quot;Arial Narrow&quot;, arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
5
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
6
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
7
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
8
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
9
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
10
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
11
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
12
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
13
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
14
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
15
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
16
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
17
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
18
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
19
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
20
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
21
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
22
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
23
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
24
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
25
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
26
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
27
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
28
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
29
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
30
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
31
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
32
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
33
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
34
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
35
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
36
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
37
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
38
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
39
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
40
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
41
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
42
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
43
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
44
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
45
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
46
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
47
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
48
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
49
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
50
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
51
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
52
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
53
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
54
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
55
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
56
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
57
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
58
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
59
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
60
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
61
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
62
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
63
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
64
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
65
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
66
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
67
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
68
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
69
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
70
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
71
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
72
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
73
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
74
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
75
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
76
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
77
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
78
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
79
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
80
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
81
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
82
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
83
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
84
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
85
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
86
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
87
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
88
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
89
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
90
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
91
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
92
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
93
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
94
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
95
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
96
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
98
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
99
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
100
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
p values
</td>
<td style="text-align:right;">
0.3989771
</td>
<td style="text-align:right;">
0.5190614
</td>
<td style="text-align:right;">
0.4601104
</td>
<td style="text-align:right;">
0.7923293
</td>
<td style="text-align:right;">
0.1553369
</td>
<td style="text-align:right;">
0.173587
</td>
<td style="text-align:right;">
0.0790656
</td>
<td style="text-align:right;">
0.1860229
</td>
<td style="text-align:right;">
0.4059915
</td>
<td style="text-align:right;">
0.3123312
</td>
<td style="text-align:right;">
0.8312241
</td>
<td style="text-align:right;">
0.2614934
</td>
<td style="text-align:right;">
0.2150162
</td>
<td style="text-align:right;">
0.2288642
</td>
<td style="text-align:right;">
0.0380427
</td>
<td style="text-align:right;">
0.43223
</td>
<td style="text-align:right;">
0.991392
</td>
<td style="text-align:right;">
0.9842236
</td>
<td style="text-align:right;">
0.6553651
</td>
<td style="text-align:right;">
0.6489628
</td>
<td style="text-align:right;">
0.4160079
</td>
<td style="text-align:right;">
0.5166883
</td>
<td style="text-align:right;">
0.4486036
</td>
<td style="text-align:right;">
0.6977665
</td>
<td style="text-align:right;">
0.313269
</td>
<td style="text-align:right;">
0.728477
</td>
<td style="text-align:right;">
0.5020349
</td>
<td style="text-align:right;">
0.201697
</td>
<td style="text-align:right;">
0.1753947
</td>
<td style="text-align:right;">
0.896115
</td>
<td style="text-align:right;">
0.5989986
</td>
<td style="text-align:right;">
0.5710472
</td>
<td style="text-align:right;">
0.7558466
</td>
<td style="text-align:right;">
0.2195294
</td>
<td style="text-align:right;">
0.5401385
</td>
<td style="text-align:right;">
0.1199292
</td>
<td style="text-align:right;">
0.6298002
</td>
<td style="text-align:right;">
0.517732
</td>
<td style="text-align:right;">
0.6144994
</td>
<td style="text-align:right;">
0.3236133
</td>
<td style="text-align:right;">
0.872392
</td>
<td style="text-align:right;">
0.5404297
</td>
<td style="text-align:right;">
0.9257846
</td>
<td style="text-align:right;">
0.768041
</td>
<td style="text-align:right;">
0.6887005
</td>
<td style="text-align:right;">
0.5524066
</td>
<td style="text-align:right;">
0.0055078
</td>
<td style="text-align:right;">
0.64871
</td>
<td style="text-align:right;">
0.1095004
</td>
<td style="text-align:right;">
0.9139441
</td>
<td style="text-align:right;">
0.3416851
</td>
<td style="text-align:right;">
0.1976245
</td>
<td style="text-align:right;">
0.589321
</td>
<td style="text-align:right;">
0.0166729
</td>
<td style="text-align:right;">
0.5960697
</td>
<td style="text-align:right;">
0.2079972
</td>
<td style="text-align:right;">
0.4576891
</td>
<td style="text-align:right;">
0.316089
</td>
<td style="text-align:right;">
0.4973581
</td>
<td style="text-align:right;">
0.418362
</td>
<td style="text-align:right;">
0.6014517
</td>
<td style="text-align:right;">
0.9855124
</td>
<td style="text-align:right;">
0.7720777
</td>
<td style="text-align:right;">
0.9034302
</td>
<td style="text-align:right;">
0.9187022
</td>
<td style="text-align:right;">
0.2816767
</td>
<td style="text-align:right;">
0.3206168
</td>
<td style="text-align:right;">
0.7993252
</td>
<td style="text-align:right;">
0.9092123
</td>
<td style="text-align:right;">
0.8600646
</td>
<td style="text-align:right;">
0.3676143
</td>
<td style="text-align:right;">
0.0729947
</td>
<td style="text-align:right;">
0.015052
</td>
<td style="text-align:right;">
0.1240839
</td>
<td style="text-align:right;">
0.383785
</td>
<td style="text-align:right;">
0.5825896
</td>
<td style="text-align:right;">
0.9049404
</td>
<td style="text-align:right;">
0.3011734
</td>
<td style="text-align:right;">
0.4145092
</td>
<td style="text-align:right;">
0.5620059
</td>
<td style="text-align:right;">
0.2985351
</td>
<td style="text-align:right;">
0.7497707
</td>
<td style="text-align:right;">
0.0886257
</td>
<td style="text-align:right;">
0.7717487
</td>
<td style="text-align:right;">
0.1529231
</td>
<td style="text-align:right;">
0.5590911
</td>
<td style="text-align:right;">
0.8497691
</td>
<td style="text-align:right;">
0.945478
</td>
<td style="text-align:right;">
0.4962063
</td>
<td style="text-align:right;">
0.2469868
</td>
<td style="text-align:right;">
0.535262
</td>
<td style="text-align:right;">
0.4095855
</td>
<td style="text-align:right;">
0.6413159
</td>
<td style="text-align:right;">
0.1588368
</td>
<td style="text-align:right;">
0.4722973
</td>
<td style="text-align:right;">
0.7148495
</td>
<td style="text-align:right;">
0.870844
</td>
<td style="text-align:right;">
0.9475619
</td>
<td style="text-align:right;">
0.8929779
</td>
<td style="text-align:right;">
0.0170991
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="exercise-6-page-214-advanced-r" class="section level2">
<h2>Exercise 6, Page 214, Advanced R</h2>
<p>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</p>
<div id="solution.-20" class="section level3">
<h3>Solution.</h3>
<p>In the below, lapply.para function is what we want. Actually, Map function will help us to neglect the index and turn the computation into parallelisation. Commonly, its arguments should be taken at least the list:x and the function:f. </p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>lapply.para =<span class="st"> </span><span class="cf">function</span>(x, f, ...){</span>
<span id="cb50-2"><a href="#cb50-2"></a>  <span class="co">#parallel computing on x by col</span></span>
<span id="cb50-3"><a href="#cb50-3"></a>  <span class="kw">Map</span>(<span class="dt">f =</span> <span class="cf">function</span>(x){<span class="kw">vapply</span>(x, <span class="dt">FUN =</span> f, <span class="dt">FUN.VALUE =</span> <span class="kw">numeric</span>(<span class="dv">1</span>))}, x)</span>
<span id="cb50-4"><a href="#cb50-4"></a>}</span>
<span id="cb50-5"><a href="#cb50-5"></a></span>
<span id="cb50-6"><a href="#cb50-6"></a>eg =<span class="st"> </span><span class="kw">list</span>(mtcars, cars)</span>
<span id="cb50-7"><a href="#cb50-7"></a></span>
<span id="cb50-8"><a href="#cb50-8"></a>ptm &lt;-<span class="st"> </span><span class="kw">proc.time</span>()</span>
<span id="cb50-9"><a href="#cb50-9"></a><span class="kw">lapply</span>(eg, <span class="cf">function</span>(x) <span class="kw">vapply</span>(x, mean, <span class="kw">numeric</span>(<span class="dv">1</span>)))</span>
<span id="cb50-10"><a href="#cb50-10"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb50-11"><a href="#cb50-11"></a><span class="co">#&gt;        mpg        cyl       disp         hp       drat         wt       qsec </span></span>
<span id="cb50-12"><a href="#cb50-12"></a><span class="co">#&gt;  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 </span></span>
<span id="cb50-13"><a href="#cb50-13"></a><span class="co">#&gt;         vs         am       gear       carb </span></span>
<span id="cb50-14"><a href="#cb50-14"></a><span class="co">#&gt;   0.437500   0.406250   3.687500   2.812500 </span></span>
<span id="cb50-15"><a href="#cb50-15"></a><span class="co">#&gt; </span></span>
<span id="cb50-16"><a href="#cb50-16"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb50-17"><a href="#cb50-17"></a><span class="co">#&gt; speed  dist </span></span>
<span id="cb50-18"><a href="#cb50-18"></a><span class="co">#&gt; 15.40 42.98</span></span>
<span id="cb50-19"><a href="#cb50-19"></a><span class="kw">proc.time</span>()<span class="op">-</span>ptm</span>
<span id="cb50-20"><a href="#cb50-20"></a><span class="co">#&gt;    user  system elapsed </span></span>
<span id="cb50-21"><a href="#cb50-21"></a><span class="co">#&gt;       0       0       0</span></span>
<span id="cb50-22"><a href="#cb50-22"></a></span>
<span id="cb50-23"><a href="#cb50-23"></a>ptm &lt;-<span class="st"> </span><span class="kw">proc.time</span>()</span>
<span id="cb50-24"><a href="#cb50-24"></a><span class="kw">lapply.para</span>(eg, mean)</span>
<span id="cb50-25"><a href="#cb50-25"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb50-26"><a href="#cb50-26"></a><span class="co">#&gt;        mpg        cyl       disp         hp       drat         wt       qsec </span></span>
<span id="cb50-27"><a href="#cb50-27"></a><span class="co">#&gt;  20.090625   6.187500 230.721875 146.687500   3.596563   3.217250  17.848750 </span></span>
<span id="cb50-28"><a href="#cb50-28"></a><span class="co">#&gt;         vs         am       gear       carb </span></span>
<span id="cb50-29"><a href="#cb50-29"></a><span class="co">#&gt;   0.437500   0.406250   3.687500   2.812500 </span></span>
<span id="cb50-30"><a href="#cb50-30"></a><span class="co">#&gt; </span></span>
<span id="cb50-31"><a href="#cb50-31"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb50-32"><a href="#cb50-32"></a><span class="co">#&gt; speed  dist </span></span>
<span id="cb50-33"><a href="#cb50-33"></a><span class="co">#&gt; 15.40 42.98</span></span>
<span id="cb50-34"><a href="#cb50-34"></a><span class="kw">proc.time</span>()<span class="op">-</span>ptm</span>
<span id="cb50-35"><a href="#cb50-35"></a><span class="co">#&gt;    user  system elapsed </span></span>
<span id="cb50-36"><a href="#cb50-36"></a><span class="co">#&gt;       0       0       0</span></span></code></pre></div>
<p>We can see the results from the two methods are the same, but somehow the parallelisation does not greatly improve the efficiency.</p>
</div>
</div>
</div>
<div id="hw-9-high-performance-with-rcpp" class="section level1">
<h1>HW 9: High performance with Rcpp</h1>
<div id="former-answer-for-exercise-9.4" class="section level2">
<h2>Former Answer for Exercise 9.4</h2>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>dlaplace =<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb51-2"><a href="#cb51-2"></a>  <span class="fl">0.5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))</span>
<span id="cb51-3"><a href="#cb51-3"></a>}</span>
<span id="cb51-4"><a href="#cb51-4"></a></span>
<span id="cb51-5"><a href="#cb51-5"></a>rw.Metropolis =<span class="st"> </span><span class="cf">function</span>(sigma, x0, N) {</span>
<span id="cb51-6"><a href="#cb51-6"></a>x =<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb51-7"><a href="#cb51-7"></a>x[<span class="dv">1</span>] =<span class="st"> </span>x0</span>
<span id="cb51-8"><a href="#cb51-8"></a>u =<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb51-9"><a href="#cb51-9"></a>k =<span class="st"> </span><span class="dv">0</span></span>
<span id="cb51-10"><a href="#cb51-10"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb51-11"><a href="#cb51-11"></a>y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb51-12"><a href="#cb51-12"></a><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dlaplace</span>(y) <span class="op">/</span><span class="st"> </span><span class="kw">dlaplace</span>(x[i<span class="dv">-1</span>])))</span>
<span id="cb51-13"><a href="#cb51-13"></a>x[i] =<span class="st"> </span>y </span>
<span id="cb51-14"><a href="#cb51-14"></a><span class="cf">else</span> {</span>
<span id="cb51-15"><a href="#cb51-15"></a>x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb51-16"><a href="#cb51-16"></a>k =<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb51-17"><a href="#cb51-17"></a>}</span>
<span id="cb51-18"><a href="#cb51-18"></a>}</span>
<span id="cb51-19"><a href="#cb51-19"></a></span>
<span id="cb51-20"><a href="#cb51-20"></a><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</span>
<span id="cb51-21"><a href="#cb51-21"></a>}</span>
<span id="cb51-22"><a href="#cb51-22"></a></span>
<span id="cb51-23"><a href="#cb51-23"></a>N =<span class="st"> </span><span class="dv">4000</span></span>
<span id="cb51-24"><a href="#cb51-24"></a>sigma =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb51-25"><a href="#cb51-25"></a>x0 =<span class="st"> </span><span class="dv">25</span></span>
<span id="cb51-26"><a href="#cb51-26"></a>rw1 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb51-27"><a href="#cb51-27"></a>rw2 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb51-28"><a href="#cb51-28"></a>rw3 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb51-29"><a href="#cb51-29"></a>rw4 =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb51-30"><a href="#cb51-30"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb51-31"><a href="#cb51-31"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="kw">t</span>(<span class="kw">paste</span>(<span class="kw">round</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k)<span class="op">/</span>N, <span class="dv">4</span>)<span class="op">*</span><span class="dv">100</span>, <span class="st">&quot;%&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)), <span class="dt">row.names =</span> <span class="st">&quot;Accpectance Rate&quot;</span>), <span class="dt">col.names =</span> <span class="kw">paste</span>(<span class="st">&quot;sigma:&quot;</span>, sigma))</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
sigma: 0.05
</th>
<th style="text-align:left;">
sigma: 0.5
</th>
<th style="text-align:left;">
sigma: 2
</th>
<th style="text-align:left;">
sigma: 16
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Accpectance Rate
</td>
<td style="text-align:left;">
97.85%
</td>
<td style="text-align:left;">
83.12%
</td>
<td style="text-align:left;">
53.85%
</td>
<td style="text-align:left;">
9.72%
</td>
</tr>
</tbody>
</table>
</div>
<div id="rcpp-for-exercise-9.4" class="section level2">
<h2>RCpp for Exercise 9.4</h2>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="kw">library</span>(StatComp20026)</span>
<span id="cb52-2"><a href="#cb52-2"></a>x =<span class="st"> </span><span class="kw">runif</span>(<span class="fl">1e4</span>); mean2 =<span class="st"> </span><span class="cf">function</span>(x)<span class="kw">sum</span>(x)<span class="op">/</span><span class="kw">length</span>(x)</span>
<span id="cb52-3"><a href="#cb52-3"></a>N =<span class="st"> </span><span class="dv">4000</span></span>
<span id="cb52-4"><a href="#cb52-4"></a>sigma =<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb52-5"><a href="#cb52-5"></a>x0 =<span class="st"> </span><span class="dv">25</span></span>
<span id="cb52-6"><a href="#cb52-6"></a>rw1 =<span class="st"> </span><span class="kw">rwM</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb52-7"><a href="#cb52-7"></a>rw2 =<span class="st"> </span><span class="kw">rwM</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb52-8"><a href="#cb52-8"></a>rw3 =<span class="st"> </span><span class="kw">rwM</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb52-9"><a href="#cb52-9"></a>rw4 =<span class="st"> </span><span class="kw">rwM</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb52-10"><a href="#cb52-10"></a></span>
<span id="cb52-11"><a href="#cb52-11"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb52-12"><a href="#cb52-12"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb52-13"><a href="#cb52-13"></a></span>
<span id="cb52-14"><a href="#cb52-14"></a><span class="kw">plot</span>(<span class="dt">y =</span> rw1[[<span class="dv">1</span>]], <span class="dt">x =</span> <span class="kw">seq_along</span>(rw1[[<span class="dv">1</span>]]),  <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb52-15"><a href="#cb52-15"></a><span class="dt">xlab=</span> <span class="st">&quot;index&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;random walk samples&quot;</span>, <span class="dt">main =</span> <span class="kw">paste0</span>(<span class="st">&quot;sigma = &quot;</span>, sigma[<span class="dv">1</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="kw">plot</span>(<span class="dt">y =</span> rw2[[<span class="dv">1</span>]], <span class="dt">x =</span> <span class="kw">seq_along</span>(rw2[[<span class="dv">1</span>]]),  <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="dt">xlab=</span> <span class="st">&quot;index&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;random walk samples&quot;</span>, <span class="dt">main =</span> <span class="kw">paste0</span>(<span class="st">&quot;sigma = &quot;</span>, sigma[<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw">plot</span>(<span class="dt">y =</span> rw3[[<span class="dv">1</span>]], <span class="dt">x =</span> <span class="kw">seq_along</span>(rw3[[<span class="dv">1</span>]]),  <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb54-2"><a href="#cb54-2"></a><span class="dt">xlab=</span> <span class="st">&quot;index&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;random walk samples&quot;</span>, <span class="dt">main =</span> <span class="kw">paste0</span>(<span class="st">&quot;sigma = &quot;</span>, sigma[<span class="dv">3</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="kw">plot</span>(<span class="dt">y =</span> rw4[[<span class="dv">1</span>]], <span class="dt">x =</span> <span class="kw">seq_along</span>(rw4[[<span class="dv">1</span>]]),  <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="dt">xlab=</span> <span class="st">&quot;index&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;random walk samples&quot;</span>, <span class="dt">main =</span> <span class="kw">paste0</span>(<span class="st">&quot;sigma = &quot;</span>, sigma[<span class="dv">4</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a></span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="co">#par(mfrow=c(1,1)) #restore default</span></span>
<span id="cb56-3"><a href="#cb56-3"></a></span>
<span id="cb56-4"><a href="#cb56-4"></a><span class="co">#number of candidate points rejected</span></span>
<span id="cb56-5"><a href="#cb56-5"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(<span class="kw">t</span>(<span class="kw">paste</span>(<span class="kw">round</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">c</span>(rw1[[<span class="dv">2</span>]], rw2[[<span class="dv">2</span>]], rw3[[<span class="dv">2</span>]], rw4[[<span class="dv">2</span>]])<span class="op">/</span>N, <span class="dv">4</span>)<span class="op">*</span><span class="dv">100</span>, <span class="st">&quot;%&quot;</span>, <span class="dt">sep =</span> <span class="st">&quot;&quot;</span>)), <span class="dt">row.names =</span> <span class="st">&quot;Accpectance Rate&quot;</span>), <span class="dt">col.names =</span> <span class="kw">paste</span>(<span class="st">&quot;sigma:&quot;</span>, sigma))</span></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
sigma: 0.05
</th>
<th style="text-align:left;">
sigma: 0.5
</th>
<th style="text-align:left;">
sigma: 2
</th>
<th style="text-align:left;">
sigma: 16
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Accpectance Rate
</td>
<td style="text-align:left;">
97.9%
</td>
<td style="text-align:left;">
82.25%
</td>
<td style="text-align:left;">
51.75%
</td>
<td style="text-align:left;">
9.45%
</td>
</tr>
</tbody>
</table>
<div id="qq-plot" class="section level3">
<h3>QQ plot</h3>
<p>Here we only choose <span class="math inline">\(\sigma = 2\)</span>, without loss of generality.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>sample.R =<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb57-2"><a href="#cb57-2"></a>sample.C =<span class="st"> </span><span class="kw">rwM</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb57-3"><a href="#cb57-3"></a></span>
<span id="cb57-4"><a href="#cb57-4"></a><span class="kw">qqplot</span>(<span class="dt">x =</span> <span class="kw">sort</span>(sample.R[[<span class="dv">1</span>]]), <span class="dt">y =</span> <span class="kw">sort</span>(sample.C[[<span class="dv">1</span>]]), <span class="dt">xlab =</span> <span class="st">&quot;Samples from R&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Samples from Cpp&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;QQ plot between R and Cpp&quot;</span>)</span>
<span id="cb57-5"><a href="#cb57-5"></a><span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="time-comparison" class="section level3">
<h3>Time Comparison</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="kw">library</span>(<span class="st">&#39;microbenchmark&#39;</span>)</span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="co">#&gt; Warning: package &#39;microbenchmark&#39; was built under R version 4.0.3</span></span>
<span id="cb58-3"><a href="#cb58-3"></a>ts =<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">sampleR=</span><span class="kw">rw.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N), <span class="dt">sampleC=</span><span class="kw">rwM</span>(sigma[<span class="dv">3</span>], x0, N))</span>
<span id="cb58-4"><a href="#cb58-4"></a><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span>
<span id="cb58-5"><a href="#cb58-5"></a><span class="co">#&gt;      expr       lq   median       uq</span></span>
<span id="cb58-6"><a href="#cb58-6"></a><span class="co">#&gt; 1 sampleR 14080.45 14979.75 16947.00</span></span>
<span id="cb58-7"><a href="#cb58-7"></a><span class="co">#&gt; 2 sampleC   845.30   880.65   908.35</span></span></code></pre></div>
</div>
<div id="comments" class="section level3">
<h3>Comments</h3>
<p>Utilization of <em>Rcpp</em> improve the efficiency greatly.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
